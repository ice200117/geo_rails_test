<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Object - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">BasicObject
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="ChinaCity.html">ChinaCity</a>
  
  
  
    <li><span class="include">NumRu</span>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-cal_var">#cal_var</a>
    
    <li ><a href="#method-i-calculate">#calculate</a>
    
    <li ><a href="#method-i-city">#city</a>
    
    <li ><a href="#method-i-city_number">#city_number</a>
    
    <li ><a href="#method-i-day_data_common">#day_data_common</a>
    
    <li ><a href="#method-i-default_25km">#default_25km</a>
    
    <li ><a href="#method-i-default_9km">#default_9km</a>
    
    <li ><a href="#method-i-fixed_write_txt">#fixed_write_txt</a>
    
    <li ><a href="#method-i-get_aqi">#get_aqi</a>
    
    <li ><a href="#method-i-get_forecast">#get_forecast</a>
    
    <li ><a href="#method-i-get_lev">#get_lev</a>
    
    <li ><a href="#method-i-get_model_by_name">#get_model_by_name</a>
    
    <li ><a href="#method-i-get_monitor">#get_monitor</a>
    
    <li ><a href="#method-i-get_rank_json">#get_rank_json</a>
    
    <li ><a href="#method-i-get_real_weahter">#get_real_weahter</a>
    
    <li ><a href="#method-i-get_tq">#get_tq</a>
    
    <li ><a href="#method-i-getdata_langfangpoint">#getdata_langfangpoint</a>
    
    <li ><a href="#method-i-getforecast_weather">#getforecast_weather</a>
    
    <li ><a href="#method-i-histroy_common">#histroy_common</a>
    
    <li ><a href="#method-i-hour_data_common">#hour_data_common</a>
    
    <li ><a href="#method-i-import_events">#import_events</a>
    
    <li ><a href="#method-i-lev">#lev</a>
    
    <li ><a href="#method-i-observation">#observation</a>
    
    <li ><a href="#method-i-parse_line">#parse_line</a>
    
    <li ><a href="#method-i-parse_lines">#parse_lines</a>
    
    <li ><a href="#method-i-parse_lines_2014">#parse_lines_2014</a>
    
    <li ><a href="#method-i-parse_lines_2015">#parse_lines_2015</a>
    
    <li ><a href="#method-i-parse_xml">#parse_xml</a>
    
    <li ><a href="#method-i-post_rank_json">#post_rank_json</a>
    
    <li ><a href="#method-i-read_adj">#read_adj</a>
    
    <li ><a href="#method-i-read_daily">#read_daily</a>
    
    <li ><a href="#method-i-read_qhd_file">#read_qhd_file</a>
    
    <li ><a href="#method-i-save_day">#save_day</a>
    
    <li ><a href="#method-i-save_db">#save_db</a>
    
    <li ><a href="#method-i-save_forecast">#save_forecast</a>
    
    <li ><a href="#method-i-save_hour">#save_hour</a>
    
    <li ><a href="#method-i-save_in_db">#save_in_db</a>
    
    <li ><a href="#method-i-set_bd_month">#set_bd_month</a>
    
    <li ><a href="#method-i-set_bd_year">#set_bd_year</a>
    
    <li ><a href="#method-i-set_change_rate">#set_change_rate</a>
    
    <li ><a href="#method-i-seven_hours_avg">#seven_hours_avg</a>
    
    <li ><a href="#method-i-station_ext">#station_ext</a>
    
    <li ><a href="#method-i-wind_power">#wind_power</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Object">
  <h1 id="class-Object" class="class">
    class Object
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="APP_PATH">APP_PATH
        
        <dd>
        
      
        <dt id="APP_ROOT">APP_ROOT
        
        <dd><p>path to your application root.</p>
        
      
        <dt id="AQI">AQI
        
        <dd>
        
      
        <dt id="CITY_LIST">CITY_LIST
        
        <dd>
        
      
        <dt id="CO">CO
        
        <dd>
        
      
        <dt id="CO_change_rate">CO_change_rate
        
        <dd>
        
      
        <dt id="NO2">NO2
        
        <dd>
        
      
        <dt id="NO2_change_rate">NO2_change_rate
        
        <dd>
        
      
        <dt id="O3">O3
        
        <dd>
        
      
        <dt id="O3_change_rate">O3_change_rate
        
        <dd>
        
      
        <dt id="SO2">SO2
        
        <dd>
        
      
        <dt id="SO2_change_rate">SO2_change_rate
        
        <dd>
        
      
        <dt id="VIS">VIS
        
        <dd>
        
      
      </dl>
    </section>
    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-cal_var" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cal_var</span><span
            class="method-args">( ncfile, var_name )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="cal_var-source">
            <pre><span class="ruby-comment"># File vendor/rdnc.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cal_var</span> ( <span class="ruby-identifier">ncfile</span>, <span class="ruby-identifier">var_name</span> )
  <span class="ruby-identifier">pl</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-constant">CITY_LIST</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">city_file</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">pl</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">read_adj</span> <span class="ruby-identifier">ncfile</span>, <span class="ruby-identifier">city_file</span>, <span class="ruby-identifier">var_name</span>)
  }
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">pl</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-calculate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">calculate</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="calculate-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/calculate.rb, line 4</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">calculate</span>
        <span class="ruby-identifier">yesterday_str</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">86400</span>).<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)<span class="ruby-operator">+</span><span class="ruby-string">&#39;20&#39;</span>
        <span class="ruby-identifier">strtime</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)
        <span class="ruby-identifier">save_path</span> = <span class="ruby-node">&quot;/mnt/share/Temp/calculate/#{strtime[0,8]}/&quot;</span>
        <span class="ruby-identifier">read_path</span> = <span class="ruby-node">&quot;/mnt/share/Temp/station_9km_orig/#{strtime[0,8]}/&quot;</span>
        <span class="ruby-constant">Dir</span><span class="ruby-operator">::</span><span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">save_path</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Dir</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">save_path</span>)
        <span class="ruby-constant">City</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">puts</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name</span>.<span class="ruby-identifier">strip</span>
                <span class="ruby-identifier">py</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span>.<span class="ruby-identifier">strip</span>
                <span class="ruby-identifier">fn</span> = <span class="ruby-node">&quot;XJ_ENVAQFC_#{py}_#{yesterday_str}_00000-07200.TXT_orig&quot;</span>
                <span class="ruby-identifier">fnout</span> = <span class="ruby-node">&quot;XJ_ENVAQFC_#{py}_#{yesterday_str}_00000-07200.TXT&quot;</span>
                <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">save_path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">save_path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>) 
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">f</span>
                <span class="ruby-identifier">f_save</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">save_path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>,<span class="ruby-string">&#39;w&#39;</span>)
                <span class="ruby-identifier">puts</span> <span class="ruby-identifier">fnout</span><span class="ruby-operator">+</span><span class="ruby-string">&#39; successful&#39;</span>

                <span class="ruby-comment">#遍历预报文件，预报数据/观测数据，生成数组begin</span>
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
                        <span class="ruby-identifier">hs</span>=<span class="ruby-identifier">get_aqi</span>(<span class="ruby-identifier">line</span>)
                        <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>]<span class="ruby-operator">&gt;</span><span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
                        <span class="ruby-identifier">tmp</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
                        <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;data_real_time &gt;= ? and data_real_time &lt;= ? and city_id = ?&quot;</span>
                        <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>].<span class="ruby-identifier">beginning_of_hour</span>
                        <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>].<span class="ruby-identifier">end_of_hour</span>
                        <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">id</span>
                        <span class="ruby-identifier">data</span> = <span class="ruby-constant">ChinaCitiesHour</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">tmp</span>)
                        <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                        <span class="ruby-identifier">f_save</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>].<span class="ruby-identifier">to_s</span><span class="ruby-operator">+</span><span class="ruby-string">&#39; &#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name</span><span class="ruby-operator">+</span><span class="ruby-string">&#39; &#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;: 差值=&gt;&#39;</span><span class="ruby-operator">+</span>(<span class="ruby-identifier">hs</span>[<span class="ruby-value">:AQI</span>].<span class="ruby-identifier">to_i</span><span class="ruby-operator">-</span><span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-constant">AQI</span>.<span class="ruby-identifier">to_i</span>).<span class="ruby-identifier">to_s</span><span class="ruby-operator">+</span><span class="ruby-string">&#39; 比值=&gt;&#39;</span><span class="ruby-operator">+</span>(<span class="ruby-identifier">hs</span>[<span class="ruby-value">:AQI</span>].<span class="ruby-identifier">to_i</span><span class="ruby-operator">/</span><span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-constant">AQI</span>).<span class="ruby-identifier">to_s</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-constant">AQI</span>.<span class="ruby-identifier">nil?</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-comment">#end</span>
                <span class="ruby-identifier">f_save</span>.<span class="ruby-identifier">close</span>()
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-city" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">city</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>修正一个城市， 参数：c(City的对象)</p>
          
          

          
          <div class="method-source-code" id="city-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix_one_city.rb, line 13</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">city</span>(<span class="ruby-identifier">c</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
        <span class="ruby-comment">#start---------------</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;--#{c.city_name}--&quot;</span>
        <span class="ruby-identifier">strtime</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">yesterday</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)
        <span class="ruby-identifier">yesterday_str</span> = <span class="ruby-identifier">strtime</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;20&#39;</span>
        
        <span class="ruby-identifier">path</span> = <span class="ruby-node">&quot;/mnt/share/Temp/station_15km/#{strtime[0,8]}/&quot;</span>
        <span class="ruby-identifier">path_fix</span> = <span class="ruby-identifier">path</span>

        <span class="ruby-identifier">default_25km_city</span> = <span class="ruby-identifier">default_25km</span>() <span class="ruby-comment">#调用缺省系数</span>
        <span class="ruby-identifier">py</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span>.<span class="ruby-identifier">strip</span>

        <span class="ruby-identifier">fn</span> = <span class="ruby-node">&quot;XJ_ENVAQFC_#{py}_#{yesterday_str}_00000-07200.TXT_adjust&quot;</span>
        <span class="ruby-identifier">fnout</span> = <span class="ruby-node">&quot;.XJ_ENVAQFC_#{py}_#{yesterday_str}_00000-07200.TXT_adjust.swap&quot;</span>
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>) 
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">f</span>

        <span class="ruby-comment">#判断预报城市是否与观测城市匹配</span>
        <span class="ruby-keyword">if</span> <span class="ruby-constant">ChinaCitiesHour</span>.<span class="ruby-identifier">find_by_city_id</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">nil?</span>
                <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path_fix</span><span class="ruby-operator">+</span><span class="ruby-identifier">fnout</span>,<span class="ruby-string">&quot;w&quot;</span>)
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">rewind</span>
                <span class="ruby-identifier">first_line</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>
                <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">first_line</span>[<span class="ruby-value">0</span>])
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-identifier">py</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
                        <span class="ruby-identifier">tmp</span> = <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-string">&#39;other&#39;</span>]
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">tmp</span> = <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-identifier">py</span>]
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">first_line</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
                        <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">fixed_write_txt</span>(<span class="ruby-identifier">line</span>,<span class="ruby-identifier">tmp</span>))
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">file</span>.<span class="ruby-identifier">close</span>
                <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>()
                <span class="ruby-keyword">return</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">lev</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">lev</span>[<span class="ruby-string">&#39;you&#39;</span>] = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">lev</span>[<span class="ruby-string">&#39;yellow&#39;</span>] = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">lev</span>[<span class="ruby-string">&#39;qingdu&#39;</span>] = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">lev</span>[<span class="ruby-string">&#39;zhong&#39;</span>] = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">lev</span>[<span class="ruby-string">&#39;zhongdu&#39;</span>] = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">lev</span>[<span class="ruby-string">&#39;yanzhong&#39;</span>] =<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>

        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">hs</span>=<span class="ruby-identifier">get_aqi</span>(<span class="ruby-identifier">line</span>)
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>]<span class="ruby-operator">&lt;</span><span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">beginning_of_day</span><span class="ruby-operator">||</span><span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>]<span class="ruby-operator">&gt;</span><span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">end_of_hour</span>
                <span class="ruby-identifier">tmp</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;data_real_time &gt;= ? and data_real_time &lt;= ? and city_id = ?&quot;</span>
                <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>].<span class="ruby-identifier">beginning_of_hour</span>
                <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>].<span class="ruby-identifier">end_of_hour</span>
                <span class="ruby-identifier">tmp</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">id</span>
                <span class="ruby-identifier">data</span> = <span class="ruby-constant">ChinaCitiesHour</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">tmp</span>)
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                <span class="ruby-identifier">lev</span>[<span class="ruby-identifier">get_lev</span>(<span class="ruby-identifier">hs</span>[<span class="ruby-value">:AQI</span>].<span class="ruby-identifier">to_i</span>)] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:AQI</span>].<span class="ruby-identifier">to_i</span><span class="ruby-operator">/</span><span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-constant">AQI</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>].<span class="ruby-constant">AQI</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">avg</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword">nil</span>]
        <span class="ruby-identifier">lev</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
                <span class="ruby-identifier">avg</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>,<span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span><span class="ruby-operator">+=</span><span class="ruby-identifier">x</span>}<span class="ruby-operator">/</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">avg_s</span> = <span class="ruby-value">1</span>
        <span class="ruby-identifier">avg</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">tmp</span> = <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
                        <span class="ruby-identifier">tmp</span> = <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-string">&#39;other&#39;</span>][<span class="ruby-identifier">k</span>]
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
                        <span class="ruby-identifier">tmp</span> = <span class="ruby-identifier">default_25km_city</span>[<span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span>][<span class="ruby-identifier">k</span>]
                <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
                        <span class="ruby-identifier">avg</span>[<span class="ruby-identifier">k</span>] = (<span class="ruby-identifier">tmp</span><span class="ruby-operator">*</span><span class="ruby-value">6</span><span class="ruby-operator">+</span><span class="ruby-identifier">v</span><span class="ruby-operator">*</span><span class="ruby-value">1</span>)<span class="ruby-operator">/</span><span class="ruby-value">7</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">avg</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">tmp</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-constant">Dir</span><span class="ruby-operator">::</span><span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">path_fix</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Dir</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path_fix</span>)
        <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path_fix</span><span class="ruby-operator">+</span><span class="ruby-identifier">fnout</span>,<span class="ruby-string">&quot;w&quot;</span>)
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">rewind</span>
        <span class="ruby-identifier">first_line</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>
        <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">first_line</span>[<span class="ruby-value">0</span>])
        <span class="ruby-identifier">first_line</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
               <span class="ruby-identifier">hs</span> = <span class="ruby-identifier">get_aqi</span>(<span class="ruby-identifier">line</span>)
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>]<span class="ruby-operator">&lt;</span><span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">beginning_of_hour</span><span class="ruby-operator">||</span><span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>]<span class="ruby-operator">&gt;</span><span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">end_of_day</span>
                        <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">line</span>)
                <span class="ruby-keyword">else</span>
                        <span class="ruby-comment"># puts line</span>
                        <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">fixed_write_txt</span>(<span class="ruby-identifier">line</span>,<span class="ruby-identifier">avg</span>))
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">file</span>.<span class="ruby-identifier">close</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>()
        <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mv</span> <span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fnout</span>,<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fnout</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-city_number" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">city_number</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="city_number-source">
            <pre><span class="ruby-comment"># File vendor/weather/city_number.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">city_number</span>
        {<span class="ruby-string">&#39;北京&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010100</span>,
        <span class="ruby-string">&#39;朝阳区&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010300</span>,
        <span class="ruby-string">&#39;顺义&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010400</span>,
        <span class="ruby-string">&#39;怀柔&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010500</span>,
        <span class="ruby-string">&#39;通州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010600</span>,
        <span class="ruby-string">&#39;昌平&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010700</span>,
        <span class="ruby-string">&#39;延庆&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010800</span>,
        <span class="ruby-string">&#39;丰台&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010900</span>,
        <span class="ruby-string">&#39;石景山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011000</span>,
        <span class="ruby-string">&#39;大兴&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011100</span>,
        <span class="ruby-string">&#39;房山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011200</span>,
        <span class="ruby-string">&#39;密云&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011300</span>,
        <span class="ruby-string">&#39;门头沟&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011400</span>,
        <span class="ruby-string">&#39;平谷&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011500</span>,
        <span class="ruby-string">&#39;八达岭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011600</span>,
        <span class="ruby-string">&#39;佛爷顶&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011700</span>,
        <span class="ruby-string">&#39;汤河口&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011800</span>,
        <span class="ruby-string">&#39;密云上甸子&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101011900</span>,
        <span class="ruby-string">&#39;斋堂&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101012000</span>,
        <span class="ruby-string">&#39;霞云岭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101012100</span>,
        <span class="ruby-string">&#39;北京城区&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101012200</span>,
        <span class="ruby-string">&#39;海淀&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101010200</span>,
        <span class="ruby-string">&#39;天津&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030100</span>,
        <span class="ruby-string">&#39;宝坻&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030300</span>,
        <span class="ruby-string">&#39;东丽&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030400</span>,
        <span class="ruby-string">&#39;西青&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030500</span>,
        <span class="ruby-string">&#39;北辰&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030600</span>,
        <span class="ruby-string">&#39;蓟县&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101031400</span>,
        <span class="ruby-string">&#39;汉沽&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030800</span>,
        <span class="ruby-string">&#39;静海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030900</span>,
        <span class="ruby-string">&#39;津南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101031000</span>,
        <span class="ruby-string">&#39;塘沽&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101031100</span>,
        <span class="ruby-string">&#39;大港&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101031200</span>,
        <span class="ruby-string">&#39;武清&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030200</span>,
        <span class="ruby-string">&#39;宁河&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101030700</span>,
        <span class="ruby-string">&#39;上海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020100</span>,
        <span class="ruby-string">&#39;宝山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020300</span>,
        <span class="ruby-string">&#39;嘉定&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020500</span>,
        <span class="ruby-string">&#39;南汇&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020600</span>,
        <span class="ruby-string">&#39;浦东&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101021300</span>,
        <span class="ruby-string">&#39;青浦&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020800</span>,
        <span class="ruby-string">&#39;松江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020900</span>,
        <span class="ruby-string">&#39;奉贤&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101021000</span>,
        <span class="ruby-string">&#39;崇明&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101021100</span>,
        <span class="ruby-string">&#39;徐家汇&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101021200</span>,
        <span class="ruby-string">&#39;闵行&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020200</span>,
        <span class="ruby-string">&#39;金山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101020700</span>,
        <span class="ruby-string">&#39;石家庄&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090101</span>,
        <span class="ruby-string">&#39;张家口&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090301</span>,
        <span class="ruby-string">&#39;承德&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090402</span>,
        <span class="ruby-string">&#39;唐山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090501</span>,
        <span class="ruby-string">&#39;秦皇岛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101091101</span>,
        <span class="ruby-string">&#39;沧州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090701</span>,
        <span class="ruby-string">&#39;衡水&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090801</span>,
        <span class="ruby-string">&#39;邢台&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090901</span>,
        <span class="ruby-string">&#39;邯郸&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101091001</span>,
        <span class="ruby-string">&#39;保定&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090201</span>,
        <span class="ruby-string">&#39;廊坊&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101090601</span>,
        <span class="ruby-string">&#39;郑州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180101</span>,
        <span class="ruby-string">&#39;新乡&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180301</span>,
        <span class="ruby-string">&#39;许昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180401</span>,
        <span class="ruby-string">&#39;平顶山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180501</span>,
        <span class="ruby-string">&#39;信阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180601</span>,
        <span class="ruby-string">&#39;南阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180701</span>,
        <span class="ruby-string">&#39;开封&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180801</span>,
        <span class="ruby-string">&#39;洛阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180901</span>,
        <span class="ruby-string">&#39;商丘&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181001</span>,
        <span class="ruby-string">&#39;焦作&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181101</span>,
        <span class="ruby-string">&#39;鹤壁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181201</span>,
        <span class="ruby-string">&#39;濮阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181301</span>,
        <span class="ruby-string">&#39;周口&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181401</span>,
        <span class="ruby-string">&#39;漯河&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181501</span>,
        <span class="ruby-string">&#39;驻马店&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181601</span>,
        <span class="ruby-string">&#39;三门峡&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181701</span>,
        <span class="ruby-string">&#39;济源&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101181801</span>,
        <span class="ruby-string">&#39;安阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101180201</span>,
        <span class="ruby-string">&#39;合肥&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220101</span>,
        <span class="ruby-string">&#39;芜湖&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220301</span>,
        <span class="ruby-string">&#39;淮南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220401</span>,
        <span class="ruby-string">&#39;马鞍山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220501</span>,
        <span class="ruby-string">&#39;安庆&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220601</span>,
        <span class="ruby-string">&#39;宿州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220701</span>,
        <span class="ruby-string">&#39;阜阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220801</span>,
        <span class="ruby-string">&#39;亳州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220901</span>,
        <span class="ruby-string">&#39;黄山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221001</span>,
        <span class="ruby-string">&#39;滁州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221101</span>,
        <span class="ruby-string">&#39;淮北&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221201</span>,
        <span class="ruby-string">&#39;铜陵&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221301</span>,
        <span class="ruby-string">&#39;宣城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221401</span>,
        <span class="ruby-string">&#39;六安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221501</span>,
        <span class="ruby-string">&#39;巢湖&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221601</span>,
        <span class="ruby-string">&#39;池州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101221701</span>,
        <span class="ruby-string">&#39;蚌埠&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101220201</span>,
        <span class="ruby-string">&#39;杭州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210101</span>,
        <span class="ruby-string">&#39;舟山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101211101</span>,
        <span class="ruby-string">&#39;湖州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210201</span>,
        <span class="ruby-string">&#39;嘉兴&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210301</span>,
        <span class="ruby-string">&#39;金华&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210901</span>,
        <span class="ruby-string">&#39;绍兴&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210501</span>,
        <span class="ruby-string">&#39;台州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210601</span>,
        <span class="ruby-string">&#39;温州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210701</span>,
        <span class="ruby-string">&#39;丽水&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210801</span>,
        <span class="ruby-string">&#39;衢州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101211001</span>,
        <span class="ruby-string">&#39;宁波&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101210401</span>,
        <span class="ruby-string">&#39;重庆&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040100</span>,
        <span class="ruby-string">&#39;合川&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040300</span>,
        <span class="ruby-string">&#39;南川&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040400</span>,
        <span class="ruby-string">&#39;江津&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040500</span>,
        <span class="ruby-string">&#39;万盛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040600</span>,
        <span class="ruby-string">&#39;渝北&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040700</span>,
        <span class="ruby-string">&#39;北碚&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040800</span>,
        <span class="ruby-string">&#39;巴南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040900</span>,
        <span class="ruby-string">&#39;长寿&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041000</span>,
        <span class="ruby-string">&#39;黔江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041100</span>,
        <span class="ruby-string">&#39;万州天城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041200</span>,
        <span class="ruby-string">&#39;万州龙宝&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041300</span>,
        <span class="ruby-string">&#39;涪陵&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041400</span>,
        <span class="ruby-string">&#39;开县&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041500</span>,
        <span class="ruby-string">&#39;城口&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041600</span>,
        <span class="ruby-string">&#39;云阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041700</span>,
        <span class="ruby-string">&#39;巫溪&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041800</span>,
        <span class="ruby-string">&#39;奉节&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101041900</span>,
        <span class="ruby-string">&#39;巫山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042000</span>,
        <span class="ruby-string">&#39;潼南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042100</span>,
        <span class="ruby-string">&#39;垫江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042200</span>,
        <span class="ruby-string">&#39;梁平&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042300</span>,
        <span class="ruby-string">&#39;忠县&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042400</span>,
        <span class="ruby-string">&#39;石柱&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042500</span>,
        <span class="ruby-string">&#39;大足&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042600</span>,
        <span class="ruby-string">&#39;荣昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042700</span>,
        <span class="ruby-string">&#39;铜梁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042800</span>,
        <span class="ruby-string">&#39;璧山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101042900</span>,
        <span class="ruby-string">&#39;丰都&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043000</span>,
        <span class="ruby-string">&#39;武隆&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043100</span>,
        <span class="ruby-string">&#39;彭水&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043200</span>,
        <span class="ruby-string">&#39;綦江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043300</span>,
        <span class="ruby-string">&#39;酉阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043400</span>,
        <span class="ruby-string">&#39;秀山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043600</span>,
        <span class="ruby-string">&#39;沙坪坝&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101043700</span>,
        <span class="ruby-string">&#39;永川&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101040200</span>,
        <span class="ruby-string">&#39;福州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230101</span>,
        <span class="ruby-string">&#39;泉州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230501</span>,
        <span class="ruby-string">&#39;漳州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230601</span>,
        <span class="ruby-string">&#39;龙岩&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230701</span>,
        <span class="ruby-string">&#39;晋江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230509</span>,
        <span class="ruby-string">&#39;南平&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230901</span>,
        <span class="ruby-string">&#39;厦门&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230201</span>,
        <span class="ruby-string">&#39;宁德&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230301</span>,
        <span class="ruby-string">&#39;莆田&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230401</span>,
        <span class="ruby-string">&#39;三明&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101230801</span>,
        <span class="ruby-string">&#39;兰州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160101</span>,
        <span class="ruby-string">&#39;平凉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160301</span>,
        <span class="ruby-string">&#39;庆阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160401</span>,
        <span class="ruby-string">&#39;武威&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160501</span>,
        <span class="ruby-string">&#39;金昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160601</span>,
        <span class="ruby-string">&#39;嘉峪关&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101161401</span>,
        <span class="ruby-string">&#39;酒泉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160801</span>,
        <span class="ruby-string">&#39;天水&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160901</span>,
        <span class="ruby-string">&#39;武都&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101161001</span>,
        <span class="ruby-string">&#39;临夏&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101161101</span>,
        <span class="ruby-string">&#39;合作&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101161201</span>,
        <span class="ruby-string">&#39;白银&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101161301</span>,
        <span class="ruby-string">&#39;定西&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160201</span>,
        <span class="ruby-string">&#39;张掖&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101160701</span>,
        <span class="ruby-string">&#39;广州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280101</span>,
        <span class="ruby-string">&#39;惠州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280301</span>,
        <span class="ruby-string">&#39;梅州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280401</span>,
        <span class="ruby-string">&#39;汕头&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280501</span>,
        <span class="ruby-string">&#39;深圳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280601</span>,
        <span class="ruby-string">&#39;珠海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280701</span>,
        <span class="ruby-string">&#39;佛山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280800</span>,
        <span class="ruby-string">&#39;肇庆&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280901</span>,
        <span class="ruby-string">&#39;湛江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281001</span>,
        <span class="ruby-string">&#39;江门&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281101</span>,
        <span class="ruby-string">&#39;河源&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281201</span>,
        <span class="ruby-string">&#39;清远&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281301</span>,
        <span class="ruby-string">&#39;云浮&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281401</span>,
        <span class="ruby-string">&#39;潮州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281501</span>,
        <span class="ruby-string">&#39;东莞&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281601</span>,
        <span class="ruby-string">&#39;中山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281701</span>,
        <span class="ruby-string">&#39;阳江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281801</span>,
        <span class="ruby-string">&#39;揭阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101281901</span>,
        <span class="ruby-string">&#39;茂名&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101282001</span>,
        <span class="ruby-string">&#39;汕尾&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101282101</span>,
        <span class="ruby-string">&#39;韶关&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101280201</span>,
        <span class="ruby-string">&#39;南宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300101</span>,
        <span class="ruby-string">&#39;柳州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300301</span>,
        <span class="ruby-string">&#39;来宾&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300401</span>,
        <span class="ruby-string">&#39;桂林&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300501</span>,
        <span class="ruby-string">&#39;梧州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300601</span>,
        <span class="ruby-string">&#39;防城港&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101301401</span>,
        <span class="ruby-string">&#39;贵港&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300801</span>,
        <span class="ruby-string">&#39;玉林&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300901</span>,
        <span class="ruby-string">&#39;百色&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101301001</span>,
        <span class="ruby-string">&#39;钦州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101301101</span>,
        <span class="ruby-string">&#39;河池&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101301201</span>,
        <span class="ruby-string">&#39;北海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101301301</span>,
        <span class="ruby-string">&#39;崇左&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300201</span>,
        <span class="ruby-string">&#39;贺州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101300701</span>,
        <span class="ruby-string">&#39;贵阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260101</span>,
        <span class="ruby-string">&#39;安顺&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260301</span>,
        <span class="ruby-string">&#39;都匀&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260401</span>,
        <span class="ruby-string">&#39;兴义&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260906</span>,
        <span class="ruby-string">&#39;铜仁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260601</span>,
        <span class="ruby-string">&#39;毕节&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260701</span>,
        <span class="ruby-string">&#39;六盘水&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260801</span>,
        <span class="ruby-string">&#39;遵义&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260201</span>,
        <span class="ruby-string">&#39;凯里&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101260501</span>,
        <span class="ruby-string">&#39;昆明&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290101</span>,
        <span class="ruby-string">&#39;红河&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290301</span>,
        <span class="ruby-string">&#39;文山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290601</span>,
        <span class="ruby-string">&#39;玉溪&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290701</span>,
        <span class="ruby-string">&#39;楚雄&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290801</span>,
        <span class="ruby-string">&#39;普洱&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290901</span>,
        <span class="ruby-string">&#39;昭通&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291001</span>,
        <span class="ruby-string">&#39;临沧&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291101</span>,
        <span class="ruby-string">&#39;怒江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291201</span>,
        <span class="ruby-string">&#39;香格里拉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291301</span>,
        <span class="ruby-string">&#39;丽江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291401</span>,
        <span class="ruby-string">&#39;德宏&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291501</span>,
        <span class="ruby-string">&#39;景洪&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101291601</span>,
        <span class="ruby-string">&#39;大理&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290201</span>,
        <span class="ruby-string">&#39;曲靖&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290401</span>,
        <span class="ruby-string">&#39;保山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101290501</span>,
        <span class="ruby-string">&#39;呼和浩特&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080101</span>,
        <span class="ruby-string">&#39;乌海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080301</span>,
        <span class="ruby-string">&#39;集宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080401</span>,
        <span class="ruby-string">&#39;通辽&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080501</span>,
        <span class="ruby-string">&#39;阿拉善左旗&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101081201</span>,
        <span class="ruby-string">&#39;鄂尔多斯&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080701</span>,
        <span class="ruby-string">&#39;临河&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080801</span>,
        <span class="ruby-string">&#39;锡林浩特&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080901</span>,
        <span class="ruby-string">&#39;呼伦贝尔&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101081000</span>,
        <span class="ruby-string">&#39;乌兰浩特&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101081101</span>,
        <span class="ruby-string">&#39;包头&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080201</span>,
        <span class="ruby-string">&#39;赤峰&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101080601</span>,
        <span class="ruby-string">&#39;南昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240101</span>,
        <span class="ruby-string">&#39;上饶&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240301</span>,
        <span class="ruby-string">&#39;抚州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240401</span>,
        <span class="ruby-string">&#39;宜春&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240501</span>,
        <span class="ruby-string">&#39;鹰潭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101241101</span>,
        <span class="ruby-string">&#39;赣州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240701</span>,
        <span class="ruby-string">&#39;景德镇&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240801</span>,
        <span class="ruby-string">&#39;萍乡&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240901</span>,
        <span class="ruby-string">&#39;新余&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101241001</span>,
        <span class="ruby-string">&#39;九江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240201</span>,
        <span class="ruby-string">&#39;吉安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101240601</span>,
        <span class="ruby-string">&#39;武汉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200101</span>,
        <span class="ruby-string">&#39;黄冈&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200501</span>,
        <span class="ruby-string">&#39;荆州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200801</span>,
        <span class="ruby-string">&#39;宜昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200901</span>,
        <span class="ruby-string">&#39;恩施&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201001</span>,
        <span class="ruby-string">&#39;十堰&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201101</span>,
        <span class="ruby-string">&#39;神农架&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201201</span>,
        <span class="ruby-string">&#39;随州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201301</span>,
        <span class="ruby-string">&#39;荆门&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201401</span>,
        <span class="ruby-string">&#39;天门&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201501</span>,
        <span class="ruby-string">&#39;仙桃&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201601</span>,
        <span class="ruby-string">&#39;潜江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101201701</span>,
        <span class="ruby-string">&#39;襄樊&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200201</span>,
        <span class="ruby-string">&#39;鄂州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200301</span>,
        <span class="ruby-string">&#39;孝感&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200401</span>,
        <span class="ruby-string">&#39;黄石&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200601</span>,
        <span class="ruby-string">&#39;咸宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101200701</span>,
        <span class="ruby-string">&#39;成都&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270101</span>,
        <span class="ruby-string">&#39;自贡&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270301</span>,
        <span class="ruby-string">&#39;绵阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270401</span>,
        <span class="ruby-string">&#39;南充&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270501</span>,
        <span class="ruby-string">&#39;达州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270601</span>,
        <span class="ruby-string">&#39;遂宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270701</span>,
        <span class="ruby-string">&#39;广安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270801</span>,
        <span class="ruby-string">&#39;巴中&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270901</span>,
        <span class="ruby-string">&#39;泸州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271001</span>,
        <span class="ruby-string">&#39;宜宾&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271101</span>,
        <span class="ruby-string">&#39;内江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271201</span>,
        <span class="ruby-string">&#39;资阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271301</span>,
        <span class="ruby-string">&#39;乐山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271401</span>,
        <span class="ruby-string">&#39;眉山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271501</span>,
        <span class="ruby-string">&#39;凉山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271601</span>,
        <span class="ruby-string">&#39;雅安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271701</span>,
        <span class="ruby-string">&#39;甘孜&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271801</span>,
        <span class="ruby-string">&#39;阿坝&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101271901</span>,
        <span class="ruby-string">&#39;德阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101272001</span>,
        <span class="ruby-string">&#39;广元&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101272101</span>,
        <span class="ruby-string">&#39;攀枝花&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101270201</span>,
        <span class="ruby-string">&#39;银川&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101170101</span>,
        <span class="ruby-string">&#39;中卫&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101170501</span>,
        <span class="ruby-string">&#39;固原&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101170401</span>,
        <span class="ruby-string">&#39;石嘴山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101170201</span>,
        <span class="ruby-string">&#39;吴忠&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101170301</span>,
        <span class="ruby-string">&#39;西宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150101</span>,
        <span class="ruby-string">&#39;黄南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150301</span>,
        <span class="ruby-string">&#39;海北&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150801</span>,
        <span class="ruby-string">&#39;果洛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150501</span>,
        <span class="ruby-string">&#39;玉树&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150601</span>,
        <span class="ruby-string">&#39;海西&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150701</span>,
        <span class="ruby-string">&#39;海东&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150201</span>,
        <span class="ruby-string">&#39;海南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101150401</span>,
        <span class="ruby-string">&#39;济南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120101</span>,
        <span class="ruby-string">&#39;潍坊&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120601</span>,
        <span class="ruby-string">&#39;临沂&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120901</span>,
        <span class="ruby-string">&#39;菏泽&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121001</span>,
        <span class="ruby-string">&#39;滨州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121101</span>,
        <span class="ruby-string">&#39;东营&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121201</span>,
        <span class="ruby-string">&#39;威海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121301</span>,
        <span class="ruby-string">&#39;枣庄&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121401</span>,
        <span class="ruby-string">&#39;日照&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121501</span>,
        <span class="ruby-string">&#39;莱芜&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121601</span>,
        <span class="ruby-string">&#39;聊城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101121701</span>,
        <span class="ruby-string">&#39;青岛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120201</span>,
        <span class="ruby-string">&#39;淄博&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120301</span>,
        <span class="ruby-string">&#39;德州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120401</span>,
        <span class="ruby-string">&#39;烟台&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120501</span>,
        <span class="ruby-string">&#39;济宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120701</span>,
        <span class="ruby-string">&#39;泰安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101120801</span>,
        <span class="ruby-string">&#39;西安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110101</span>,
        <span class="ruby-string">&#39;延安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110300</span>,
        <span class="ruby-string">&#39;榆林&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110401</span>,
        <span class="ruby-string">&#39;铜川&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101111001</span>,
        <span class="ruby-string">&#39;商洛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110601</span>,
        <span class="ruby-string">&#39;安康&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110701</span>,
        <span class="ruby-string">&#39;汉中&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110801</span>,
        <span class="ruby-string">&#39;宝鸡&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110901</span>,
        <span class="ruby-string">&#39;咸阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110200</span>,
        <span class="ruby-string">&#39;渭南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101110501</span>,
        <span class="ruby-string">&#39;太原&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100101</span>,
        <span class="ruby-string">&#39;临汾&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100701</span>,
        <span class="ruby-string">&#39;运城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100801</span>,
        <span class="ruby-string">&#39;朔州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100901</span>,
        <span class="ruby-string">&#39;忻州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101101001</span>,
        <span class="ruby-string">&#39;长治&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100501</span>,
        <span class="ruby-string">&#39;大同&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100201</span>,
        <span class="ruby-string">&#39;阳泉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100301</span>,
        <span class="ruby-string">&#39;晋中&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100401</span>,
        <span class="ruby-string">&#39;晋城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101100601</span>,
        <span class="ruby-string">&#39;吕梁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101101100</span>,
        <span class="ruby-string">&#39;乌鲁木齐&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130101</span>,
        <span class="ruby-string">&#39;石河子&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130301</span>,
        <span class="ruby-string">&#39;昌吉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130401</span>,
        <span class="ruby-string">&#39;吐鲁番&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130501</span>,
        <span class="ruby-string">&#39;库尔勒&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130601</span>,
        <span class="ruby-string">&#39;阿拉尔&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130701</span>,
        <span class="ruby-string">&#39;阿克苏&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130801</span>,
        <span class="ruby-string">&#39;喀什&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130901</span>,
        <span class="ruby-string">&#39;伊宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131001</span>,
        <span class="ruby-string">&#39;塔城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131101</span>,
        <span class="ruby-string">&#39;哈密&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131201</span>,
        <span class="ruby-string">&#39;和田&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131301</span>,
        <span class="ruby-string">&#39;阿勒泰&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131401</span>,
        <span class="ruby-string">&#39;阿图什&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131501</span>,
        <span class="ruby-string">&#39;博乐&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101131601</span>,
        <span class="ruby-string">&#39;克拉玛依&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101130201</span>,
        <span class="ruby-string">&#39;拉萨&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140101</span>,
        <span class="ruby-string">&#39;山南&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140301</span>,
        <span class="ruby-string">&#39;阿里&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140701</span>,
        <span class="ruby-string">&#39;昌都&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140501</span>,
        <span class="ruby-string">&#39;那曲&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140601</span>,
        <span class="ruby-string">&#39;日喀则&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140201</span>,
        <span class="ruby-string">&#39;林芝&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101140401</span>,
        <span class="ruby-string">&#39;台北县&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101340101</span>,
        <span class="ruby-string">&#39;高雄&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101340201</span>,
        <span class="ruby-string">&#39;台中&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101340401</span>,
        <span class="ruby-string">&#39;海口&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310101</span>,
        <span class="ruby-string">&#39;三亚&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310201</span>,
        <span class="ruby-string">&#39;东方&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310202</span>,
        <span class="ruby-string">&#39;临高&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310203</span>,
        <span class="ruby-string">&#39;澄迈&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310204</span>,
        <span class="ruby-string">&#39;儋州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310205</span>,
        <span class="ruby-string">&#39;昌江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310206</span>,
        <span class="ruby-string">&#39;白沙&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310207</span>,
        <span class="ruby-string">&#39;琼中&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310208</span>,
        <span class="ruby-string">&#39;定安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310209</span>,
        <span class="ruby-string">&#39;屯昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310210</span>,
        <span class="ruby-string">&#39;琼海&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310211</span>,
        <span class="ruby-string">&#39;文昌&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310212</span>,
        <span class="ruby-string">&#39;保亭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310214</span>,
        <span class="ruby-string">&#39;万宁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310215</span>,
        <span class="ruby-string">&#39;陵水&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310216</span>,
        <span class="ruby-string">&#39;西沙&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310217</span>,
        <span class="ruby-string">&#39;南沙岛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310220</span>,
        <span class="ruby-string">&#39;乐东&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310221</span>,
        <span class="ruby-string">&#39;五指山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310222</span>,
        <span class="ruby-string">&#39;琼山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101310102</span>,
        <span class="ruby-string">&#39;长沙&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250101</span>,
        <span class="ruby-string">&#39;株洲&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250301</span>,
        <span class="ruby-string">&#39;衡阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250401</span>,
        <span class="ruby-string">&#39;郴州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250501</span>,
        <span class="ruby-string">&#39;常德&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250601</span>,
        <span class="ruby-string">&#39;益阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250700</span>,
        <span class="ruby-string">&#39;娄底&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250801</span>,
        <span class="ruby-string">&#39;邵阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250901</span>,
        <span class="ruby-string">&#39;岳阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101251001</span>,
        <span class="ruby-string">&#39;张家界&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101251101</span>,
        <span class="ruby-string">&#39;怀化&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101251201</span>,
        <span class="ruby-string">&#39;黔阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101251301</span>,
        <span class="ruby-string">&#39;永州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101251401</span>,
        <span class="ruby-string">&#39;吉首&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101251501</span>,
        <span class="ruby-string">&#39;湘潭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101250201</span>,
        <span class="ruby-string">&#39;南京&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190101</span>,
        <span class="ruby-string">&#39;镇江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190301</span>,
        <span class="ruby-string">&#39;苏州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190401</span>,
        <span class="ruby-string">&#39;南通&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190501</span>,
        <span class="ruby-string">&#39;扬州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190601</span>,
        <span class="ruby-string">&#39;宿迁&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101191301</span>,
        <span class="ruby-string">&#39;徐州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190801</span>,
        <span class="ruby-string">&#39;淮安&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190901</span>,
        <span class="ruby-string">&#39;连云港&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101191001</span>,
        <span class="ruby-string">&#39;常州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101191101</span>,
        <span class="ruby-string">&#39;泰州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101191201</span>,
        <span class="ruby-string">&#39;无锡&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190201</span>,
        <span class="ruby-string">&#39;盐城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101190701</span>,
        <span class="ruby-string">&#39;哈尔滨&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050101</span>,
        <span class="ruby-string">&#39;牡丹江&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050301</span>,
        <span class="ruby-string">&#39;佳木斯&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050401</span>,
        <span class="ruby-string">&#39;绥化&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050501</span>,
        <span class="ruby-string">&#39;黑河&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050601</span>,
        <span class="ruby-string">&#39;双鸭山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101051301</span>,
        <span class="ruby-string">&#39;伊春&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050801</span>,
        <span class="ruby-string">&#39;大庆&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050901</span>,
        <span class="ruby-string">&#39;七台河&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101051002</span>,
        <span class="ruby-string">&#39;鸡西&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101051101</span>,
        <span class="ruby-string">&#39;鹤岗&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101051201</span>,
        <span class="ruby-string">&#39;齐齐哈尔&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050201</span>,
        <span class="ruby-string">&#39;大兴安岭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101050701</span>,
        <span class="ruby-string">&#39;长春&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060101</span>,
        <span class="ruby-string">&#39;延吉&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060301</span>,
        <span class="ruby-string">&#39;四平&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060401</span>,
        <span class="ruby-string">&#39;白山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060901</span>,
        <span class="ruby-string">&#39;白城&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060601</span>,
        <span class="ruby-string">&#39;辽源&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060701</span>,
        <span class="ruby-string">&#39;松原&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060801</span>,
        <span class="ruby-string">&#39;吉林&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060201</span>,
        <span class="ruby-string">&#39;通化&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101060501</span>,
        <span class="ruby-string">&#39;沈阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070101</span>,
        <span class="ruby-string">&#39;鞍山&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070301</span>,
        <span class="ruby-string">&#39;抚顺&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070401</span>,
        <span class="ruby-string">&#39;本溪&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070501</span>,
        <span class="ruby-string">&#39;丹东&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070601</span>,
        <span class="ruby-string">&#39;葫芦岛&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101071401</span>,
        <span class="ruby-string">&#39;营口&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070801</span>,
        <span class="ruby-string">&#39;阜新&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070901</span>,
        <span class="ruby-string">&#39;辽阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101071001</span>,
        <span class="ruby-string">&#39;铁岭&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101071101</span>,
        <span class="ruby-string">&#39;朝阳&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101071201</span>,
        <span class="ruby-string">&#39;盘锦&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101071301</span>,
        <span class="ruby-string">&#39;大连&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070201</span>,
        <span class="ruby-string">&#39;锦州&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">101070701</span>
        }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-day_data_common" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">day_data_common</span><span
            class="method-args">(hs,model)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="day_data_common-source">
            <pre><span class="ruby-comment"># File vendor/getdata/getdaydata.rb, line 4</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">day_data_common</span>(<span class="ruby-identifier">hs</span>,<span class="ruby-identifier">model</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">hs</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span> 
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:time</span>].<span class="ruby-identifier">to_time</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">data_real_time</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_25km" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_25km</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>25km缺省值写入哈希，此处为方便计算</p>
          
          

          
          <div class="method-source-code" id="default_25km-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 149</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default_25km</span>
        <span class="ruby-identifier">cities_default</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">city_index</span> = <span class="ruby-identifier">station_ext</span>()

        <span class="ruby-comment">#begin 长江口</span>
        <span class="ruby-identifier">changjiangkou</span> = {<span class="ruby-string">&#39;you&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.58</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.68</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.68</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>}
        <span class="ruby-comment">#行号减一为i值</span>
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">in</span> (<span class="ruby-value">79</span><span class="ruby-operator">..</span><span class="ruby-value">103</span>)
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> <span class="ruby-operator">==</span> <span class="ruby-value">93</span>
                <span class="ruby-comment"># puts e.to_s+&#39; &#39;+city_index[e]</span>
                <span class="ruby-identifier">cities_default</span>[<span class="ruby-identifier">city_index</span>[<span class="ruby-identifier">e</span>]] = <span class="ruby-identifier">changjiangkou</span>
        <span class="ruby-keyword">end</span>            
        <span class="ruby-comment">#end 长江口</span>
        <span class="ruby-comment">#</span>
        <span class="ruby-comment">#begin 东北</span>
        <span class="ruby-identifier">dongbei</span> = {<span class="ruby-string">&#39;you&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>}
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">in</span> (<span class="ruby-value">44</span><span class="ruby-operator">..</span><span class="ruby-value">79</span>)
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> <span class="ruby-operator">==</span> <span class="ruby-value">57</span>
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> <span class="ruby-operator">==</span> <span class="ruby-value">66</span>
                <span class="ruby-identifier">cities_default</span>[<span class="ruby-identifier">city_index</span>[<span class="ruby-identifier">e</span>]] = <span class="ruby-identifier">dongbei</span>
                <span class="ruby-comment"># puts e.to_s+&#39; &#39;+city_index[e]</span>
        <span class="ruby-keyword">end</span>            
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shenyangshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.98</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;changchunshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.78</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;haerbinshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.98</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>}
        <span class="ruby-comment">#end 东北</span>
        <span class="ruby-comment">#</span>
        <span class="ruby-comment">#shangdongshen 山东</span>
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        <span class="ruby-identifier">shandongsheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.68</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.82</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.75</span> }
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        <span class="ruby-identifier">shandongsheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.12</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.20</span> }
<span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">master</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;jinanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.91</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.7</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span> }
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        <span class="ruby-identifier">shandongsheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.32</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.40</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;jinanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.15</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.17</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span> }
<span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">b90ede2214dc96a31b36e092746c86f7d13002de</span>
        <span class="ruby-comment"># for e in (142..157)</span>
                <span class="ruby-comment"># next if e == 57</span>
                <span class="ruby-comment"># next if e == 66</span>
                <span class="ruby-comment"># cities_default[city_index[e]] = shandongsheng</span>
                <span class="ruby-comment"># puts e.to_s+&#39; &#39;+city_index[e]</span>
        <span class="ruby-comment"># end  </span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;dezhoushi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;linyishi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;rizhaoshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;binzhoushi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;dongyingshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shouguangshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhangqiushi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;weifangshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;ziboshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;liaochengshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hezeshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zaozhuangshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;binzhoushi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;weifangshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;dongyingshi&#39;</span>] = <span class="ruby-identifier">shandongsheng</span>
        <span class="ruby-comment">#end </span>
        <span class="ruby-comment">#</span>
        <span class="ruby-comment">#hebeisheng not used </span>
        <span class="ruby-identifier">hengshuishi</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.09</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.15</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hengshuishi&#39;</span>] = <span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;handanshi&#39;</span>]=<span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shijiazhuangshi&#39;</span>] = <span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xingtaishi&#39;</span>] = <span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;tangshanshi&#39;</span>] = <span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-comment"># cities_default[&#39;chengdeshi&#39;] = hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;cangzhoushi&#39;</span>] = <span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;tianjinshi&#39;</span>] = <span class="ruby-identifier">hengshuishi</span>
        <span class="ruby-comment"># cities_default[&#39;qinhuangdaoshi&#39;] = hengshuishi</span>
        <span class="ruby-comment"># cities_default[&#39;zhangjiakoushi&#39;] = hengshuishi</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;baodingshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.58</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.98</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;langfangshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span> }
        <span class="ruby-comment">#end</span>
        <span class="ruby-comment">#</span>
        <span class="ruby-comment">#henansheng 河南</span>
        <span class="ruby-identifier">hennansheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.09</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.38</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span>,<span class="ruby-string">&#39;yanzhong&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1.45</span>}
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhengzhoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.23</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.23</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;yanzhong&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1.25</span>}
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhengzhoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.23</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;yanzhong&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1.35</span>}
<span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">master</span>
        <span class="ruby-comment"># for e in (159..174)</span>
                <span class="ruby-comment"># next if e == 57</span>
                <span class="ruby-comment"># next if e == 66</span>
                <span class="ruby-comment"># cities_default[city_index[e]] = hennansheng</span>
                <span class="ruby-comment"># puts e.to_s+&#39; &#39;+city_index[e]</span>
        <span class="ruby-comment"># end  </span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;kaifengshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;luoyangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;pingdingshanshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;anyangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hebeishi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xinxiangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;jiaozuoshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;puyangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xuchangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;luoheshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;sanmenxiashi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;nanyangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shangqiushi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xinyangshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhoukoushi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
         <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhumadianshi&#39;</span>] = <span class="ruby-identifier">hennansheng</span>
        <span class="ruby-comment">#end</span>
        <span class="ruby-comment">#shanxi 山西</span>
        <span class="ruby-identifier">shanxisheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.18</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.38</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.38</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.5</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xianshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xianyangshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hanzhongshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;baojishi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;linfenshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;yananshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;bazhongshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;tongchuanshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;jiuquanshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;qinyangshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;pingliangshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;guyuanshi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;dazhoushi&#39;</span>] = <span class="ruby-identifier">shanxisheng</span>
        <span class="ruby-comment">#end</span>
        <span class="ruby-comment">#end</span>
        <span class="ruby-comment">#</span>
        <span class="ruby-comment">#hubeisheng 湖北</span>
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        <span class="ruby-identifier">hubeisheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.48</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.78</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.8</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;wuhanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.48</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.58</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.65</span>}
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        <span class="ruby-identifier">hubeisheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.19</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.48</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.78</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.8</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;wuhanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.09</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.48</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.58</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.65</span>}
<span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">master</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;huangshishi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xiaoganshi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;jingmenshi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;huanggangshi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shiyanshi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;ezhoushi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;jingzhoushi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;luzhoushi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;maanshanshi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;wuhushi&#39;</span>] = <span class="ruby-identifier">hubeisheng</span>
        <span class="ruby-comment">#end</span>
        <span class="ruby-comment">#xinjiang 新疆</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;wulumuqishi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.3</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.38</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.48</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;changjihuizuzizhiz&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.3</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.38</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.48</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>}
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.4</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.48</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.68</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;kashidiqu&#39;</span>] = <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] 
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.1</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.48</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.68</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;kashidiqu&#39;</span>] = <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] 
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;kezilesukeerkezizi&#39;</span>] = <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] 
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;tulufandiqu&#39;</span>] = <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] 
<span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">master</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shannandiqu&#39;</span>] = <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] 
        <span class="ruby-comment">#end</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hangzhoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.25</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.58</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.58</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.35</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hetiandiqu&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.4</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.48</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.68</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xianshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.98</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.28</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.78</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.98</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">2.11</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;guangzhoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.6</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.38</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.48</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.5</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;other&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.58</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.68</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.58</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.5</span>}
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">cities_default</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_9km" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_9km</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>设置9km缺省系数，与计算得到的系数求平均值</p>
          
          

          
          <div class="method-source-code" id="default_9km-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 104</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default_9km</span>
        <span class="ruby-identifier">cities_default</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">city_index</span> = <span class="ruby-identifier">station_ext</span>()
        <span class="ruby-comment"># north of JJJ</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;chengdeshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.6</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.6</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.34</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.51</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhangjiakoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.34</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.51</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;qinhuangdaoshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.1</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.00</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.51</span>}
        <span class="ruby-comment"># end</span>
        <span class="ruby-comment"># centre of JJJ</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;beijingshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.80</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.84</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.99</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.80</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.80</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;baodingshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.80</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.84</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.99</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.10</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;langfangshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.70</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.91</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;tianjinshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.99</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span> }
        
        <span class="ruby-comment"># end </span>
        <span class="ruby-comment"># south of JJJ</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;tangshanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.2</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">1.2</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.30</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.00</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;hengshuishi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.91</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.04</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;cangzhoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.96</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.91</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.04</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;xingtaishi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.04</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.91</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;handanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.04</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span>}
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shijiazhuangshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.70</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.94</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.88</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.81</span> }
        <span class="ruby-comment"># end</span>
        <span class="ruby-comment"># liaoning 辽宁</span>
        <span class="ruby-identifier">liaoningsheng</span> = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.80</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.94</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.05</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.08</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span> }
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">in</span> (<span class="ruby-value">44</span><span class="ruby-operator">..</span><span class="ruby-value">56</span>)
                <span class="ruby-comment"># next if e == 93</span>
                <span class="ruby-comment"># puts e.to_s+&#39; &#39;+city_index[e]</span>
                <span class="ruby-identifier">cities_default</span>[<span class="ruby-identifier">city_index</span>[<span class="ruby-identifier">e</span>]] = <span class="ruby-identifier">liaoningsheng</span>
        <span class="ruby-keyword">end</span>            
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;shenyangshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.80</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0.94</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.85</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.98</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span> }
        <span class="ruby-comment"># end</span>
        <span class="ruby-comment"># shanxi 山西</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;taiyuanshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1.04</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.11</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.45</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.68</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.81</span> }
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;datongshi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.34</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.51</span>}
        <span class="ruby-comment"># end</span>
        <span class="ruby-comment"># henan 河南</span>
        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;zhengzhoushi&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.95</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.34</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.51</span>}
        <span class="ruby-comment"># end</span>

        <span class="ruby-identifier">cities_default</span>[<span class="ruby-string">&#39;other&#39;</span>] = {<span class="ruby-string">&#39;you&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.8</span>,<span class="ruby-string">&#39;yellow&#39;</span> =<span class="ruby-operator">&gt;</span><span class="ruby-value">0.9</span>,<span class="ruby-string">&#39;qingdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">0.90</span>,<span class="ruby-string">&#39;zhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.01</span>,<span class="ruby-string">&#39;zhongdu&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.34</span>,<span class="ruby-string">&#39;yanzhong&#39;</span>=<span class="ruby-operator">&gt;</span><span class="ruby-value">1.51</span>}
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">cities_default</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-fixed_write_txt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fixed_write_txt</span><span
            class="method-args">(line,avg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="fixed_write_txt-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 92</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fixed_write_txt</span>(<span class="ruby-identifier">line</span>,<span class="ruby-identifier">avg</span>)
        <span class="ruby-identifier">aqi</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-comment">#line[14,4] = avg[get_lev(aqi)]*aqi if !avg[get_lev(aqi)].nil? </span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">avg</span>[<span class="ruby-identifier">get_lev</span>(<span class="ruby-identifier">aqi</span>)].<span class="ruby-identifier">nil?</span> 
                <span class="ruby-identifier">fix_aqi</span> = (<span class="ruby-identifier">aqi</span><span class="ruby-operator">/</span><span class="ruby-identifier">avg</span>[<span class="ruby-identifier">get_lev</span>(<span class="ruby-identifier">aqi</span>)]).<span class="ruby-identifier">round</span>
                <span class="ruby-identifier">fix_aqi</span> = <span class="ruby-value">500</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">fix_aqi</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">500</span>
                <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>] = <span class="ruby-string">&quot; %3d&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">fix_aqi</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">line</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_aqi" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_aqi</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>获取预报数据的预报时间，AQI</p>
          
          

          
          <div class="method-source-code" id="get_aqi-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_aqi</span>(<span class="ruby-identifier">line</span>)
        <span class="ruby-identifier">sd</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">10</span>]
        <span class="ruby-identifier">delta_hour</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">11</span>,<span class="ruby-value">3</span>]
        <span class="ruby-identifier">sdate</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">sd</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">4</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">6</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">8</span>,<span class="ruby-value">2</span>])

        <span class="ruby-identifier">hs</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">hs</span>[<span class="ruby-value">:forecast_datetime</span>] = <span class="ruby-identifier">sdate</span><span class="ruby-operator">+</span><span class="ruby-identifier">delta_hour</span>.<span class="ruby-identifier">to_i</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>
        <span class="ruby-identifier">hs</span>[<span class="ruby-value">:AQI</span>] = <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>]
        <span class="ruby-identifier">hs</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_forecast" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_forecast</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>获取预测数据</p>
          
          

          
          <div class="method-source-code" id="get_forecast-source">
            <pre><span class="ruby-comment"># File test/test.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_forecast</span>
        <span class="ruby-identifier">city_name_encode</span> = <span class="ruby-constant">ERB</span><span class="ruby-operator">::</span><span class="ruby-constant">Util</span>.<span class="ruby-identifier">url_encode</span>(<span class="ruby-string">&quot;保定市&quot;</span>)
        <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">headers</span>={<span class="ruby-string">&#39;apikey&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;f8484c1661a905c5ca470b0d90af8d9f&#39;</span>}
        <span class="ruby-identifier">options</span>[<span class="ruby-value">:headers</span>] = <span class="ruby-identifier">headers</span>
        <span class="ruby-identifier">url</span> = <span class="ruby-node">&quot;http://apis.baidu.com/showapi_open_bus/weather_showapi/address?area=#{city_name_encode}&amp;needMoreDay=1&quot;</span>
        <span class="ruby-identifier">response</span> = <span class="ruby-constant">HTTParty</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">url</span>,<span class="ruby-identifier">options</span>)
        <span class="ruby-identifier">json</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)
        <span class="ruby-identifier">puts</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">json</span>[<span class="ruby-string">&#39;showapi_res_error&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">weather</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">json</span>[<span class="ruby-string">&#39;showapi_res_body&#39;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">weather</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">get_tq</span>(<span class="ruby-identifier">v</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">temp</span> = <span class="ruby-constant">HourlyCityForecastAirQuality</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">air_quality_forecast</span>(<span class="ruby-string">&#39;baodingshi&#39;</span>)
        <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">v</span>[<span class="ruby-string">&quot;fore_lev&quot;</span>] = <span class="ruby-identifier">get_lev</span>(<span class="ruby-identifier">v</span>[<span class="ruby-string">&quot;AQI&quot;</span>])
                <span class="ruby-identifier">weather</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)]=<span class="ruby-identifier">weather</span>[<span class="ruby-identifier">k</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">v</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">weather</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_lev" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_lev</span><span
            class="method-args">(a)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_lev-source">
            <pre><span class="ruby-comment"># File test/test_forecast.rb, line 70</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_lev</span>(<span class="ruby-identifier">a</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-value">0</span> <span class="ruby-operator">..</span> <span class="ruby-value">50</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">lev</span> = <span class="ruby-string">&#39;you&#39;</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-value">50</span> <span class="ruby-operator">..</span> <span class="ruby-value">100</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">lev</span> = <span class="ruby-string">&#39;yellow&#39;</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-value">100</span> <span class="ruby-operator">..</span> <span class="ruby-value">150</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">lev</span> = <span class="ruby-string">&#39;qingdu&#39;</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-value">150</span> <span class="ruby-operator">..</span> <span class="ruby-value">200</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">lev</span> = <span class="ruby-string">&#39;zhong&#39;</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-value">200</span> <span class="ruby-operator">..</span> <span class="ruby-value">300</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">lev</span> = <span class="ruby-string">&#39;zhongdu&#39;</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-value">300</span> <span class="ruby-operator">..</span> <span class="ruby-value">500</span>) <span class="ruby-operator">===</span> <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">lev</span> = <span class="ruby-string">&#39;yanzhong&#39;</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_model_by_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_model_by_name</span><span
            class="method-args">(city_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_model_by_name-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 27</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_model_by_name</span>(<span class="ruby-identifier">city_name</span>)
        <span class="ruby-identifier">model</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">if</span> <span class="ruby-constant">CityEnum</span>.<span class="ruby-identifier">baoding</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">city_name</span>)
                <span class="ruby-identifier">model</span> = <span class="ruby-constant">TempBdHour</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-constant">CityEnum</span>.<span class="ruby-identifier">langfang</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">city_name</span>)
                <span class="ruby-identifier">model</span> = <span class="ruby-constant">TempLfHour</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-constant">CityEnum</span>.<span class="ruby-identifier">china_city_74</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">city_name</span>)
                <span class="ruby-identifier">model</span> = <span class="ruby-constant">TempSfcitiesHour</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">model</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">model</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_monitor" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_monitor</span><span
            class="method-args">(id,time)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_monitor-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_monitor</span>(<span class="ruby-identifier">id</span>,<span class="ruby-identifier">time</span>)
        <span class="ruby-identifier">model</span> = <span class="ruby-identifier">get_model_by_id</span>(<span class="ruby-identifier">id</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;city not find&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
        <span class="ruby-identifier">stime</span> = <span class="ruby-identifier">time</span>.<span class="ruby-identifier">beginning_of_hour</span>
        <span class="ruby-identifier">etime</span> = <span class="ruby-identifier">time</span>.<span class="ruby-identifier">end_of_hour</span>
        <span class="ruby-identifier">sql</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;data_real_time &gt;= ? and data_real_time &lt;= ? and id = ?&quot;</span>
        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">stime</span>
        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">etime</span>
        <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">id</span>
        <span class="ruby-identifier">data_ary</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">sql</span>)
        <span class="ruby-identifier">data_ary</span>[<span class="ruby-value">0</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_rank_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_rank_json</span><span
            class="method-args">(date)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_rank_json-source">
            <pre><span class="ruby-comment"># File vendor/getrank_simple.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_rank_json</span>(<span class="ruby-identifier">date</span>)
  <span class="ruby-identifier">datestr</span> = <span class="ruby-identifier">date</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y-%m-%d&quot;</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-constant">HTTParty</span>.<span class="ruby-identifier">get</span>(<span class="ruby-string">&#39;http://115.28.227.231:8082/api/data/day-qxday?date=&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">datestr</span>)
    <span class="ruby-identifier">json_data</span>=<span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">json_data</span>
    <span class="ruby-identifier">dc</span> = <span class="ruby-constant">DayCity</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-keyword">rescue</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Can not get data from izhenqi, please check network!&#39;</span>
  <span class="ruby-keyword">end</span> 
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_real_weahter" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_real_weahter</span><span
            class="method-args">(city_number)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_real_weahter-source">
            <pre><span class="ruby-comment"># File vendor/get_weather.rb, line 16</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_real_weahter</span>(<span class="ruby-identifier">city_number</span>)
  <span class="ruby-identifier">xmldoc</span> = <span class="ruby-constant">Nokogiri</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span>(<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;http://wthrcdn.etouch.cn/WeatherApi?citykey=&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">city_number</span>.<span class="ruby-identifier">to_s</span>))

  <span class="ruby-identifier">weather</span> = {}
  <span class="ruby-comment"># 气象要素</span>
  <span class="ruby-identifier">elements</span> = <span class="ruby-node">%w[aqi city updatetime wendu fengli shidu fengxiang sunrise_1 sunset_1 ]</span>
  <span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">weather</span>[<span class="ruby-identifier">e</span>] = <span class="ruby-identifier">parse_xml</span>(<span class="ruby-identifier">xmldoc</span>, <span class="ruby-identifier">e</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">weather</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_tq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_tq</span><span
            class="method-args">(f1)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>天气处理与get_forecast合作使用</p>
          
          

          
          <div class="method-source-code" id="get_tq-source">
            <pre><span class="ruby-comment"># File test/test.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_tq</span>(<span class="ruby-identifier">f1</span>)
        <span class="ruby-identifier">tq</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;tq&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_weather&#39;</span>]
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_air_temperature&#39;</span>][<span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;℃&#39;</span>
                <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;temp1&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_air_temperature&#39;</span>][<span class="ruby-value">0</span>,<span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_air_temperature&#39;</span>].<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]
        <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;temp1&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_air_temperature&#39;</span>] 
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;temp2&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_air_temperature&#39;</span>]
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;无持续风向&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;无持续风向&#39;</span>
                <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;wd&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>]
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;无持续风向&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;无持续风向&#39;</span>
                <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;wd&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>]
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;无持续风向&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;无持续风向&#39;</span>
                <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;wd&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>]
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;无持续风向&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;无持续风向&#39;</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>] 
                        <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;wd&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>]
                <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>] 
                        <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;wd&#39;</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_direction&#39;</span>]<span class="ruby-operator">+</span><span class="ruby-string">&#39;~&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_direction&#39;</span>]
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">dw</span> = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day_wind_power&#39;</span>]
        <span class="ruby-identifier">nw</span> = <span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;night_wind_power&#39;</span>]
        <span class="ruby-keyword">def</span> <span class="ruby-identifier">wind_power</span>(<span class="ruby-identifier">wp</span>)
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">wp</span>[<span class="ruby-value">0</span>,<span class="ruby-value">2</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">wp</span>[<span class="ruby-value">0</span>,<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;微风&#39;</span>
                <span class="ruby-keyword">for</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">in</span> (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">wp</span>.<span class="ruby-identifier">size</span>)
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">wp</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">e</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">wp</span>[<span class="ruby-identifier">e</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;级&#39;</span>
                <span class="ruby-keyword">end</span>           
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">dw</span> = <span class="ruby-identifier">wind_power</span>(<span class="ruby-identifier">dw</span>)
        <span class="ruby-identifier">nw</span> = <span class="ruby-identifier">wind_power</span>(<span class="ruby-identifier">nw</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">dw</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">nw</span>
                <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;ws&#39;</span>] = <span class="ruby-identifier">dw</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dw</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">nw</span>
                <span class="ruby-identifier">dw</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">nw</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;ws&#39;</span>] = <span class="ruby-identifier">nw</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;~&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dw</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">tq</span>[<span class="ruby-string">&#39;ws&#39;</span>] = <span class="ruby-identifier">dw</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;~&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">nw</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">tq</span>[<span class="ruby-identifier">f1</span>[<span class="ruby-string">&#39;day&#39;</span>].<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)] = <span class="ruby-identifier">tq</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-getdata_langfangpoint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getdata_langfangpoint</span><span
            class="method-args">(date)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="getdata_langfangpoint-source">
            <pre><span class="ruby-comment"># File vendor/getrank_simple.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getdata_langfangpoint</span>(<span class="ruby-identifier">date</span>)
  <span class="ruby-identifier">datestr</span> = <span class="ruby-identifier">date</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y-%m-%d&quot;</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-constant">HTTParty</span>.<span class="ruby-identifier">get</span>(<span class="ruby-string">&#39;http://www.izhenqi.cn/api/getdata_langfangpoint.php?type=2&amp;date=&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">datestr</span>)
    <span class="ruby-identifier">json_data</span>=<span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">json_data</span>
    <span class="ruby-identifier">dc</span> = <span class="ruby-constant">DayCity</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-keyword">rescue</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Can not get data from izhenqi, please check network!&#39;</span>
  <span class="ruby-keyword">end</span> 
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-getforecast_weather" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getforecast_weather</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="getforecast_weather-source">
            <pre><span class="ruby-comment"># File vendor/getrank_simple.rb, line 49</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">getforecast_weather</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-constant">HTTParty</span>.<span class="ruby-identifier">get</span>(<span class="ruby-string">&#39;http://www.izhenqi.cn/api/getforecast_weather.php&#39;</span>)
    <span class="ruby-identifier">json_data</span>=<span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">json_data</span>
    <span class="ruby-identifier">dc</span> = <span class="ruby-constant">DayCity</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-keyword">rescue</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Can not get data from izhenqi, please check network!&#39;</span>
  <span class="ruby-keyword">end</span> 

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-histroy_common" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">histroy_common</span><span
            class="method-args">(stime,etime,city_list,model)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>历史脚本通用方法</p>
          
          

          
          <div class="method-source-code" id="histroy_common-source">
            <pre><span class="ruby-comment"># File vendor/getdata/gethistroy_rank.rb, line 4</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">histroy_common</span>(<span class="ruby-identifier">stime</span>,<span class="ruby-identifier">etime</span>,<span class="ruby-identifier">city_list</span>,<span class="ruby-identifier">model</span>)
        <span class="ruby-keyword">while</span> <span class="ruby-identifier">stime</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">etime</span>
                <span class="ruby-identifier">common_get_month_year</span>(<span class="ruby-identifier">city_list</span>,<span class="ruby-identifier">model</span>,<span class="ruby-identifier">stime</span>)
                <span class="ruby-identifier">stime</span> <span class="ruby-operator">+=</span> <span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-value">24</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-hour_data_common" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">hour_data_common</span><span
            class="method-args">(hs,model)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="hour_data_common-source">
            <pre><span class="ruby-comment"># File vendor/getdata/gethourdata.rb, line 5</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">hour_data_common</span>(<span class="ruby-identifier">hs</span>,<span class="ruby-identifier">model</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">hs</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span> 
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">hs</span>[<span class="ruby-value">:time</span>].<span class="ruby-identifier">to_time</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">model</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">data_real_time</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-import_events" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">import_events</span><span
            class="method-args">(client, file)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="import_events-source">
            <pre><span class="ruby-comment"># File vendor/air_quality_forecast/import_eventserver.rb, line 15</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">import_events</span>(<span class="ruby-identifier">client</span>, <span class="ruby-identifier">file</span>)<span class="ruby-operator">:</span>
        <span class="ruby-identifier">f</span> = <span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-string">&#39;r&#39;</span>)
        <span class="ruby-identifier">count</span> = <span class="ruby-value">0</span>
        <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;Importing data...&quot;</span>
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">line</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">f</span><span class="ruby-operator">:</span>
                <span class="ruby-identifier">data</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">rstrip</span>(<span class="ruby-string">&#39;\r\n&#39;</span>).<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;,&quot;</span>)
                <span class="ruby-identifier">plan</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value">0</span>]
                <span class="ruby-identifier">attr</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot; &quot;</span>)

                <span class="ruby-identifier">client</span>.<span class="ruby-identifier">create_event</span>(
                        <span class="ruby-identifier">event</span>=<span class="ruby-string">&quot;$set&quot;</span>,
                        <span class="ruby-identifier">entity_type</span>=<span class="ruby-string">&quot;training_point&quot;</span>,
                        <span class="ruby-identifier">entity_id</span>=<span class="ruby-identifier">str</span>(<span class="ruby-identifier">count</span>), <span class="ruby-comment"># use the count num as user ID</span>
                        <span class="ruby-identifier">properties</span>= {
                                <span class="ruby-string">&quot;attr0&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">0</span>]),
                                <span class="ruby-string">&quot;attr1&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">1</span>]),
                                <span class="ruby-string">&quot;attr2&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">2</span>]),
                                <span class="ruby-string">&quot;attr3&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">3</span>]),
                                <span class="ruby-string">&quot;attr4&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">4</span>]),
                                <span class="ruby-string">&quot;attr5&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">5</span>]),
                                <span class="ruby-string">&quot;attr6&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">6</span>]),
                                <span class="ruby-string">&quot;attr7&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">attr</span>[<span class="ruby-value">7</span>]),
                                <span class="ruby-string">&quot;plan&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">float</span>(<span class="ruby-identifier">plan</span>)
                        }
                )
                <span class="ruby-identifier">count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>()
        <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;%s events are imported.&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-lev" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">lev</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="lev-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">lev</span>()

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-observation" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">observation</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>time=Time.now.yesterday.beginning_of_day+9*3600
HourlyCityForecastAirQuality.where(“publish_datetime &gt;= ? AND city_id =
11”,time).each do |line|</p>

<pre class="ruby"><span class="ruby-identifier">line</span>.<span class="ruby-constant">AQI</span>=<span class="ruby-identifier">seven_hours_avg</span>(<span class="ruby-identifier">line</span>.<span class="ruby-identifier">forecast_datetime</span>)
<span class="ruby-identifier">line</span>.<span class="ruby-identifier">save</span>
</pre>

<p>end</p>
          
          

          
          <div class="method-source-code" id="observation-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix_qhd.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">observation</span>
        <span class="ruby-identifier">time</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">beginning_of_day</span>
        <span class="ruby-identifier">hs</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-constant">ChinaCitiesHour</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;data_real_time &gt;= ? AND city_id = 11&quot;</span>,<span class="ruby-identifier">time</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">hs</span>[<span class="ruby-identifier">line</span>.<span class="ruby-identifier">data_real_time</span>]=<span class="ruby-identifier">line</span>.<span class="ruby-constant">AQI</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">hs</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parse_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_line</span><span
            class="method-args">(line, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parse_line-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 71</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_line</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">c</span>)
        <span class="ruby-identifier">hc</span> = <span class="ruby-constant">HourlyCityForecastAirQuality</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">sd</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">10</span>]
        <span class="ruby-identifier">delta_hour</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">11</span>,<span class="ruby-value">3</span>]
        <span class="ruby-identifier">sdate</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">sd</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">4</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">6</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">8</span>,<span class="ruby-value">2</span>])
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">publish_datetime</span> = <span class="ruby-identifier">sdate</span>
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">forecast_datetime</span> = <span class="ruby-identifier">sdate</span><span class="ruby-operator">+</span><span class="ruby-identifier">delta_hour</span>.<span class="ruby-identifier">to_i</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>
        <span class="ruby-identifier">hc</span>.<span class="ruby-constant">AQI</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">main_pol</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">18</span>,<span class="ruby-value">13</span>].<span class="ruby-identifier">strip</span>
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">grade</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">31</span>,<span class="ruby-value">1</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">pm25</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">99</span>,<span class="ruby-value">6</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">pm10</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">87</span>,<span class="ruby-value">6</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-constant">SO2</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">39</span>,<span class="ruby-value">6</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-constant">CO</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">63</span>,<span class="ruby-value">6</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-constant">NO2</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">51</span>,<span class="ruby-value">6</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-constant">O3</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">75</span>,<span class="ruby-value">6</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-constant">VIS</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">32</span>,<span class="ruby-value">7</span>]
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">city_id</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">id</span>
        <span class="ruby-identifier">hc</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parse_lines" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_lines</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>get_avg.rb Copyright (C) 2015-12-29 libaoxi
&lt;vagrant@vagrant-ubuntu-trusty-64&gt;</p>

<p>Distributed under terms of the MIT license.</p>
          
          

          
          <div class="method-source-code" id="parse_lines-source">
            <pre><span class="ruby-comment"># File get_avg.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_lines</span>(<span class="ruby-identifier">line</span>)
        <span class="ruby-identifier">sd</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">10</span>]
        <span class="ruby-identifier">delta_hour</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">11</span>,<span class="ruby-value">3</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-identifier">sdate</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">sd</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">4</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">6</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">8</span>,<span class="ruby-value">2</span>])
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&gt;</span><span class="ruby-value">28</span><span class="ruby-operator">&amp;&amp;</span><span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">53</span>
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">29</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;small&quot;</span> 
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&gt;</span><span class="ruby-value">52</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;big&quot;</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parse_lines_2014" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_lines_2014</span><span
            class="method-args">(line, factor="AQI")</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>get_avg.rb Copyright (C) 2015-12-29 libaoxi
&lt;vagrant@vagrant-ubuntu-trusty-64&gt;</p>

<p>Distributed under terms of the MIT license.</p>
          
          

          
          <div class="method-source-code" id="parse_lines_2014-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/get_avg_zqq1.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_lines_2014</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">factor</span>=<span class="ruby-string">&quot;AQI&quot;</span>)
        <span class="ruby-comment"># sd = line[0,10]</span>
        <span class="ruby-identifier">delta_hour</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-comment"># sdate = Time.local(sd[0,4],sd[4,2],sd[6,2],sd[8,2])</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&gt;</span><span class="ruby-value">28</span><span class="ruby-operator">&amp;&amp;</span><span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">53</span>
                <span class="ruby-keyword">case</span> <span class="ruby-identifier">factor</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;AQI&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">4</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;pm25&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">83</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;pm10&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">71</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;SO2&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">23</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;CO&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">47</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;O3&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">59</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;NO2&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">35</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;else&quot;</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">29</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;small&quot;</span> 
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&gt;</span><span class="ruby-value">52</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;big&quot;</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parse_lines_2015" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_lines_2015</span><span
            class="method-args">(line, factor="AQI")</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parse_lines_2015-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/get_avg_zqq1.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_lines_2015</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">factor</span>=<span class="ruby-string">&quot;AQI&quot;</span>)
        <span class="ruby-identifier">sd</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">10</span>]
        <span class="ruby-identifier">delta_hour</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">11</span>,<span class="ruby-value">3</span>].<span class="ruby-identifier">to_i</span>
        <span class="ruby-identifier">sdate</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">sd</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">4</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">6</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">8</span>,<span class="ruby-value">2</span>])
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&gt;</span><span class="ruby-value">28</span><span class="ruby-operator">&amp;&amp;</span><span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">53</span>
                <span class="ruby-keyword">case</span> <span class="ruby-identifier">factor</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;AQI&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;pm25&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">99</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;pm10&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">87</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;SO2&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">39</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;CO&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">63</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;O3&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">75</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;NO2&quot;</span>
                        <span class="ruby-keyword">return</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">51</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">to_f</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;else&quot;</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&lt;</span><span class="ruby-value">29</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;small&quot;</span> 
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">delta_hour</span><span class="ruby-operator">&gt;</span><span class="ruby-value">52</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;big&quot;</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parse_xml" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_xml</span><span
            class="method-args">(doc, node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parse_xml-source">
            <pre><span class="ruby-comment"># File vendor/get_weather.rb, line 6</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_xml</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">node</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;aqi&#39;</span>
    <span class="ruby-identifier">n</span>=<span class="ruby-identifier">doc</span>.<span class="ruby-identifier">at_css</span>(<span class="ruby-string">&quot;environment aqi&quot;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">n</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">at_css</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">n</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">text</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39;&#39;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-post_rank_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">post_rank_json</span><span
            class="method-args">(secretstr,typestr,datestr='')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>def <a
href="Object.html#method-i-post_rank_json">#post_rank_json</a>(webUrl,secretstr,typestr,datestr)</p>
          
          

          
          <div class="method-source-code" id="post_rank_json-source">
            <pre><span class="ruby-comment"># File vendor/getrank_simple.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">post_rank_json</span>(<span class="ruby-identifier">secretstr</span>,<span class="ruby-identifier">typestr</span>,<span class="ruby-identifier">datestr</span>=<span class="ruby-string">&#39;&#39;</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">datestr</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">option</span> = {<span class="ruby-identifier">secret</span><span class="ruby-value">:secretstr</span>,<span class="ruby-identifier">type</span><span class="ruby-value">:typestr</span>,<span class="ruby-identifier">key</span><span class="ruby-value">:Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">secretstr</span><span class="ruby-operator">+</span><span class="ruby-identifier">typestr</span>) }
    <span class="ruby-identifier">response</span> = <span class="ruby-constant">HTTParty</span>.<span class="ruby-identifier">post</span>(<span class="ruby-string">&#39;http://www.izhenqi.cn/api/getrank.php&#39;</span>, <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">option</span>)
    <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">option</span> = {<span class="ruby-identifier">secret</span><span class="ruby-value">:secretstr</span>,<span class="ruby-identifier">type</span><span class="ruby-value">:typestr</span>,<span class="ruby-identifier">key</span><span class="ruby-value">:Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">secretstr</span><span class="ruby-operator">+</span><span class="ruby-identifier">typestr</span>) }
    <span class="ruby-identifier">response</span> = <span class="ruby-constant">HTTParty</span>.<span class="ruby-identifier">post</span>(<span class="ruby-string">&#39;http://www.izhenqi.cn/api/getdata_cityrank.php&#39;</span>, <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">option</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">json_data</span>=<span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">json_data</span>
    <span class="ruby-identifier">hs</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">hs</span>[<span class="ruby-value">:time</span>] =<span class="ruby-identifier">json_data</span>[<span class="ruby-string">&#39;time&#39;</span>]
    <span class="ruby-identifier">hs</span>[<span class="ruby-value">:cities</span>] = <span class="ruby-identifier">json_data</span>[<span class="ruby-string">&#39;rows&#39;</span>]
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;Can not get data from izhenqi, please check network!&#39;</span>
  <span class="ruby-keyword">end</span> 
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-read_adj" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read_adj</span><span
            class="method-args">(ncfile, city_file, var_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="read_adj-source">
            <pre><span class="ruby-comment"># File vendor/rdnc.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_adj</span> (<span class="ruby-identifier">ncfile</span>, <span class="ruby-identifier">city_file</span>, <span class="ruby-identifier">var_name</span>)
  <span class="ruby-identifier">file</span> = <span class="ruby-constant">NetCDF</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">ncfile</span>)
  

  <span class="ruby-comment"># Get longitude</span>
  <span class="ruby-identifier">var</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">var</span>(<span class="ruby-identifier">var_name</span>)
  <span class="ruby-identifier">data</span> = <span class="ruby-identifier">var</span>.<span class="ruby-identifier">get</span>
  <span class="ruby-comment">#puts data.shape</span>
  
  <span class="ruby-identifier">x</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">y</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-comment">#puts city_file</span>
  <span class="ruby-identifier">lines</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">city_file</span>)
  <span class="ruby-identifier">num_points</span> = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
  <span class="ruby-comment">#lines.each { |line|</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">lines</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">as</span> = <span class="ruby-identifier">lines</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">split</span>(<span class="ruby-identifier">pattern</span>=<span class="ruby-string">&#39; &#39;</span>) 
    <span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">as</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">y</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">as</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment">#}</span>

  <span class="ruby-identifier">sum_per</span> = <span class="ruby-value">0.0</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">num_points</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
    <span class="ruby-comment">#puts data[x[i],y[i],0,0]</span>
    <span class="ruby-identifier">sum_per</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-value">0</span>,<span class="ruby-value">0</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">sum_per</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-read_daily" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read_daily</span><span
            class="method-args">( ncfile, city_file )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="read_daily-source">
            <pre><span class="ruby-comment"># File vendor/rdnc.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_daily</span> ( <span class="ruby-identifier">ncfile</span>, <span class="ruby-identifier">city_file</span> )
  <span class="ruby-identifier">file</span> = <span class="ruby-constant">NetCDF</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">ncfile</span>)

  <span class="ruby-comment"># Get longitude</span>
  <span class="ruby-identifier">vlon</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">var</span>(<span class="ruby-string">&quot;lon&quot;</span>)
  <span class="ruby-identifier">lon</span> = <span class="ruby-identifier">vlon</span>.<span class="ruby-identifier">get</span>

  <span class="ruby-comment"># Get latitude</span>
  <span class="ruby-identifier">vlat</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">var</span>(<span class="ruby-string">&quot;lat&quot;</span>)
  <span class="ruby-identifier">lat</span> = <span class="ruby-identifier">vlat</span>.<span class="ruby-identifier">get</span>

  <span class="ruby-comment"># Get time</span>
  <span class="ruby-identifier">vtime</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">var</span>(<span class="ruby-string">&quot;time&quot;</span>)
  <span class="ruby-identifier">time</span> = <span class="ruby-identifier">vtime</span>.<span class="ruby-identifier">get</span>
  <span class="ruby-identifier">t</span> =  <span class="ruby-constant">Time</span>.<span class="ruby-identifier">utc</span>(<span class="ruby-value">1900</span>,<span class="ruby-value">1</span>,<span class="ruby-value">1</span>,<span class="ruby-value">0</span>)
  <span class="ruby-identifier">tb</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-identifier">ttime</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">4</span>
    <span class="ruby-identifier">ttime</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">time</span>[<span class="ruby-identifier">i</span>]<span class="ruby-operator">*</span><span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-value">60</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">tb</span>).<span class="ruby-identifier">getutc</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">time</span>[<span class="ruby-identifier">i</span>]<span class="ruby-operator">*</span><span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-value">60</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">tb</span>).<span class="ruby-identifier">getutc</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">strvars</span> = [<span class="ruby-string">&quot;PM2_5&quot;</span>, <span class="ruby-string">&quot;PM10&quot;</span>, <span class="ruby-string">&quot;SO2&quot;</span>, <span class="ruby-string">&quot;CO&quot;</span>, <span class="ruby-string">&quot;NO2&quot;</span>, <span class="ruby-string">&quot;O3&quot;</span>, <span class="ruby-string">&quot;AQI&quot;</span>, <span class="ruby-string">&quot;VIS&quot;</span>]
  <span class="ruby-comment"># Get AQI</span>
  <span class="ruby-identifier">vars</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">vars</span>(<span class="ruby-identifier">strvars</span>)
  <span class="ruby-comment">#var.each_att{ |a|</span>
    <span class="ruby-comment">#print a.name,&quot;\n&quot;</span>
  <span class="ruby-comment">#}</span>
  <span class="ruby-comment">#puts file.dim(&quot;time&quot;).name</span>
  <span class="ruby-comment">#puts var.ndims</span>
  <span class="ruby-comment">#for i in 0..2</span>
    <span class="ruby-comment">#puts var.dim(i).name</span>
    <span class="ruby-comment">#puts var.dim(i).length</span>
  <span class="ruby-comment">#end</span>
  <span class="ruby-identifier">dataArr</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">vars</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">var</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">data</span> = <span class="ruby-identifier">var</span>.<span class="ruby-identifier">get</span>
    <span class="ruby-identifier">dataArr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span>
  }
  <span class="ruby-comment">#puts ary3d.shape</span>
  <span class="ruby-comment">#</span>

  <span class="ruby-identifier">x</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">y</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">lines</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">city_file</span>)
  <span class="ruby-identifier">num_line</span> = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">num_line</span>
  <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">as</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">pattern</span>=<span class="ruby-string">&#39; &#39;</span>) 
    <span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">as</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">y</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">as</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
  }

  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">num_line</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-value">1</span>]
  <span class="ruby-keyword">end</span>


  <span class="ruby-comment"># Open a database</span>
  <span class="ruby-comment">#db = SQLite3::Database.new &quot;/home/lice/forecastAQI/db/development.sqlite3&quot;</span>
  <span class="ruby-identifier">db</span> = <span class="ruby-constant">PG</span><span class="ruby-operator">::</span><span class="ruby-constant">Connection</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-value">5432</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-string">&#39;forecastAQI_development&#39;</span>, <span class="ruby-string">&#39;pguser&#39;</span>, <span class="ruby-string">&#39;pguser&#39;</span>)

  <span class="ruby-comment">## Create a database</span>
  <span class="ruby-comment">#rows = db.execute &lt;&lt;-SQL</span>
    <span class="ruby-comment">#create table numbers (</span>
      <span class="ruby-comment">#name varchar(30),</span>
      <span class="ruby-comment">#val int</span>
    <span class="ruby-comment">#);</span>
  <span class="ruby-comment">#SQL</span>

  <span class="ruby-comment">## Execute a few inserts</span>
  <span class="ruby-comment">#{</span>
    <span class="ruby-comment">#&quot;one&quot; =&gt; 1,</span>
    <span class="ruby-comment">#&quot;two&quot; =&gt; 2,</span>
  <span class="ruby-comment">#}.each do |pair|</span>
    <span class="ruby-comment">#db.execute &quot;insert into numbers values ( ?, ? )&quot;, pair</span>
  <span class="ruby-comment">#end</span>

  <span class="ruby-comment">## Execute inserts with parameter markers</span>
  <span class="ruby-comment">#db.execute(&quot;INSERT INTO students (name, email, grade, blog) </span>
              <span class="ruby-comment">#VALUES (?, ?, ?, ?)&quot;, [@name, @email, @grade, @blog])</span>

  <span class="ruby-identifier">fpl</span> = <span class="ruby-constant">ForecastPoint</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-identifier">fpl</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">fp</span><span class="ruby-operator">|</span> <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">destroy</span> }

  <span class="ruby-comment"># Insert forecast points</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">j</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">ttime</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">num_line</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-identifier">i</span>
      <span class="ruby-identifier">fp</span> = <span class="ruby-constant">ForecastPoint</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">longitude</span>      = <span class="ruby-identifier">lon</span>[<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>]] 
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">latitude</span>       = <span class="ruby-identifier">lat</span>[<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>]] 
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">publish_date</span>   = <span class="ruby-identifier">ttime</span>[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">forecast_date</span>  = <span class="ruby-identifier">ttime</span>[<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">pm25</span>           = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">pm10</span>           = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-constant">SO2</span>            = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">2</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-constant">CO</span>             = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">3</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-constant">NO2</span>            = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">4</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-constant">O3</span>             = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">5</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-constant">AQI</span>            = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">6</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-constant">VIS</span>            = <span class="ruby-identifier">dataArr</span>[<span class="ruby-value">7</span>][<span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">y</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">j</span>]
      <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">save</span> 
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Find a few rows</span>
  <span class="ruby-comment">#db.execute( &quot;select * from forecast_points&quot; ) do |row|</span>
  <span class="ruby-identifier">fps</span> = <span class="ruby-constant">ForecastPoint</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-identifier">fps</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">p</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">longitude</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-read_qhd_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read_qhd_file</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>fore_fix_qhd.rb Copyright (C) 2016 libaoxi &lt;693879111@qq.com&gt;</p>

<p>Distributed under terms of the MIT license.</p>
          
          

          
          <div class="method-source-code" id="read_qhd_file-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix_qhd.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_qhd_file</span>
        <span class="ruby-identifier">path</span>=<span class="ruby-string">&quot;/mnt/share/Temp/station_9km_orig/20160303/&quot;</span>
        <span class="ruby-identifier">name</span> = <span class="ruby-string">&quot;XJ_ENVAQFC_qinhuangdaoshi_2016030220_00000-07200.TXT_orig&quot;</span>
        <span class="ruby-identifier">hs</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">file</span>,<span class="ruby-string">&quot;r&quot;</span>).<span class="ruby-identifier">readlines</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">name</span>,<span class="ruby-string">&quot;r&quot;</span>).<span class="ruby-identifier">readlines</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
<span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;&gt;</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">b90ede2214dc96a31b36e092746c86f7d13002de</span>
                <span class="ruby-identifier">sd</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">10</span>]
                <span class="ruby-identifier">delta_hour</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">11</span>,<span class="ruby-value">3</span>]
                <span class="ruby-identifier">sdate</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">sd</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">4</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">6</span>,<span class="ruby-value">2</span>],<span class="ruby-identifier">sd</span>[<span class="ruby-value">8</span>,<span class="ruby-value">2</span>])
                <span class="ruby-identifier">forecast_datetime</span> = <span class="ruby-identifier">sdate</span><span class="ruby-operator">+</span><span class="ruby-identifier">delta_hour</span>.<span class="ruby-identifier">to_i</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>
                <span class="ruby-identifier">aqi</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">14</span>,<span class="ruby-value">4</span>]
                <span class="ruby-identifier">hs</span>[<span class="ruby-identifier">forecast_datetime</span>]=<span class="ruby-identifier">aqi</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">hs</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">def</span> <span class="ruby-identifier">seven_hours_avg</span>(<span class="ruby-identifier">time</span>)
        <span class="ruby-identifier">temp</span>=<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">data</span>=<span class="ruby-identifier">read_qhd_file</span>()
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        (<span class="ruby-value">-3</span><span class="ruby-operator">..</span><span class="ruby-value">3</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">temp</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">data</span>[<span class="ruby-identifier">time</span><span class="ruby-operator">+</span><span class="ruby-identifier">n</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>] <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">data</span>[<span class="ruby-identifier">time</span><span class="ruby-operator">+</span><span class="ruby-identifier">n</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>].<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>,<span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span><span class="ruby-operator">+=</span><span class="ruby-identifier">x</span>}<span class="ruby-operator">/</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">time</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">begining_of_day</span><span class="ruby-operator">+</span><span class="ruby-value">9</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>
<span class="ruby-constant">ChinaCitiesHour</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;publish_datetime &gt;= ? AND city_id 11&quot;</span>,<span class="ruby-identifier">time</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">line</span>.<span class="ruby-constant">AQI</span>=<span class="ruby-identifier">seven_hours_avg</span>(<span class="ruby-identifier">line</span>.<span class="ruby-identifier">forecast_datetime</span>)
        <span class="ruby-identifier">line</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span>
<span class="ruby-operator">===</span><span class="ruby-operator">===</span>=
        (<span class="ruby-value">-5</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">temp</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">data</span>[<span class="ruby-identifier">time</span><span class="ruby-operator">+</span><span class="ruby-identifier">n</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>] <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">data</span>[<span class="ruby-identifier">time</span><span class="ruby-operator">+</span><span class="ruby-identifier">n</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>].<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">leng</span>=<span class="ruby-identifier">temp</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>,<span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span><span class="ruby-operator">+=</span><span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_i</span>}<span class="ruby-operator">/</span><span class="ruby-identifier">leng</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_day" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_day</span><span
            class="method-args">(data,id)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_day-source">
            <pre><span class="ruby-comment"># File vendor/weather/save_in_db.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_day</span>(<span class="ruby-identifier">data</span>,<span class="ruby-identifier">id</span>)
        <span class="ruby-identifier">w</span> = <span class="ruby-constant">WeatherDay</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">city_id</span> = <span class="ruby-identifier">id</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">publish_datetime</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">yesterday</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">high</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;high_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">low</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;low_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">day_type</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;day_1&#39;</span>][<span class="ruby-string">&#39;type_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">day_fx</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;day_1&#39;</span>][<span class="ruby-string">&#39;fx_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">day_fl</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;day_1&#39;</span>][<span class="ruby-string">&#39;fl_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">night_type</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;night_1&#39;</span>][<span class="ruby-string">&#39;type_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">night_fx</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;night_1&#39;</span>][<span class="ruby-string">&#39;fx_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">night_fl</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;night_1&#39;</span>][<span class="ruby-string">&#39;fl_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_db" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_db</span><span
            class="method-args">(time,id,flag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_db-source">
            <pre><span class="ruby-comment"># File vendor/bd_save_month_year.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_db</span>(<span class="ruby-identifier">time</span>,<span class="ruby-identifier">id</span>,<span class="ruby-identifier">flag</span>)
  
        <span class="ruby-identifier">day_city</span> = <span class="ruby-identifier">get_db_data</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-string">&#39;new&#39;</span>,<span class="ruby-keyword">nil</span>)
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">city_id</span>=<span class="ruby-identifier">id</span>
        <span class="ruby-keyword">case</span> <span class="ruby-identifier">flag</span>
        <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;temp_bd_months&#39;</span>
                <span class="ruby-identifier">t</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-identifier">t</span>=<span class="ruby-identifier">get_avg_by_month</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-identifier">id</span>,<span class="ruby-identifier">time</span>)
        <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;temp_bd_years&#39;</span>
                <span class="ruby-identifier">t</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-identifier">t</span>=<span class="ruby-identifier">get_avg_by_year</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-identifier">id</span>,<span class="ruby-identifier">time</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">SO2</span>=<span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;so2&#39;</span>]
        <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">NO2</span>=<span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;no2&#39;</span>]
        <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">CO</span>=<span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;co&#39;</span>]
        <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">O3</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;o3&#39;</span>]
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">pm10</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;pm10&#39;</span>]
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">pm25</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;pm2_5&#39;</span>]
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">data_real_time</span>=<span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_time</span>
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">day_city</span>=<span class="ruby-identifier">get_db_data</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-string">&#39;last&#39;</span>,<span class="ruby-keyword">nil</span>)
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">zonghezhishu</span>=<span class="ruby-identifier">get_zonghezhishu</span>(<span class="ruby-identifier">flag</span>)
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">day_city</span>=<span class="ruby-identifier">get_db_data</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-string">&#39;last&#39;</span>,<span class="ruby-keyword">nil</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_time</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_i</span><span class="ruby-operator">&gt;</span><span class="ruby-value">2014</span>.<span class="ruby-identifier">to_i</span>
                <span class="ruby-identifier">change_rate</span> = <span class="ruby-identifier">get_change_rate</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-identifier">id</span>,<span class="ruby-identifier">time</span>)
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">change_rate</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">SO2_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:SO2</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">NO2_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:NO2</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">CO_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:CO</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">O3_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:O3</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">pm10_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:pm10</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">pm25_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:pm25</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">zongheindex_change_rate</span> = <span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:zhzs</span>]
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;==&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">flag</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;==&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_s</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;=save OK!==&#39;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_forecast" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_forecast</span><span
            class="method-args">(data,id)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_forecast-source">
            <pre><span class="ruby-comment"># File vendor/weather/save_in_db.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_forecast</span>(<span class="ruby-identifier">data</span>,<span class="ruby-identifier">id</span>)
        <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;forecast&#39;</span>][<span class="ruby-string">&#39;weather&#39;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">w</span> = <span class="ruby-constant">WeatherForecast</span>.<span class="ruby-identifier">new</span>
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">city_id</span> = <span class="ruby-identifier">id</span>
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">publish_datetime</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;updatetime&#39;</span>].<span class="ruby-identifier">to_time</span>
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">forecast_datetime</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;date&#39;</span>].<span class="ruby-identifier">to_time</span>
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">high</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;high&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">low</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;low&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">day_type</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;day&#39;</span>][<span class="ruby-string">&#39;type&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">day_fx</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;day&#39;</span>][<span class="ruby-string">&#39;fengxiang&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">day_fl</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;day&#39;</span>][<span class="ruby-string">&#39;fengli&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">night_type</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;night&#39;</span>][<span class="ruby-string">&#39;type&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">night_fx</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;night&#39;</span>][<span class="ruby-string">&#39;fengxiang&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">night_fl</span> = <span class="ruby-identifier">t</span>[<span class="ruby-string">&#39;night&#39;</span>][<span class="ruby-string">&#39;fengli&#39;</span>]
                <span class="ruby-identifier">w</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_hour" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_hour</span><span
            class="method-args">(data,id)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_hour-source">
            <pre><span class="ruby-comment"># File vendor/weather/save_in_db.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_hour</span>(<span class="ruby-identifier">data</span>,<span class="ruby-identifier">id</span>)
        <span class="ruby-identifier">w</span> = <span class="ruby-constant">WeatherHour</span>.<span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">city_id</span><span class="ruby-value">:id</span>,<span class="ruby-identifier">publish_datetime</span><span class="ruby-value">:data</span>[<span class="ruby-string">&#39;updatetime&#39;</span>].<span class="ruby-identifier">to_time</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w</span>.<span class="ruby-identifier">wendu</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">city_id</span> = <span class="ruby-identifier">id</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">publish_datetime</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;updatetime&#39;</span>].<span class="ruby-identifier">to_time</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">wendu</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;wendu&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">fengli</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;fengli&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">shidu</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;shidu&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">fengxiang</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;fengxiang&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">sunrise</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;sunrise_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">sunset</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;sunset_1&#39;</span>]
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">zhishu</span> = <span class="ruby-identifier">data</span>[<span class="ruby-string">&#39;zhishus&#39;</span>][<span class="ruby-string">&#39;zhishu&#39;</span>].<span class="ruby-identifier">to_s</span>
        <span class="ruby-identifier">w</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_in_db" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_in_db</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_in_db-source">
            <pre><span class="ruby-comment"># File vendor/rd_hourly_aqi_every_hour.rb, line 32</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_in_db</span>(<span class="ruby-identifier">c</span>)
        <span class="ruby-comment">#strtime = Time.mktime(Time.new.strftime(&quot;%Y%m%d&quot;)+&#39;08&#39;)</span>
        <span class="ruby-identifier">strtime</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">yesterday</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-string">&quot;%Y%m%d&quot;</span>)
        <span class="ruby-identifier">yesterday_str</span> = <span class="ruby-identifier">strtime</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;08&#39;</span>
        <span class="ruby-comment"># strtime = &#39;20160126&#39;</span>
        <span class="ruby-comment"># yesterday_str = &#39;2016012608&#39;</span>

        <span class="ruby-identifier">path</span> = <span class="ruby-node">&quot;/mnt/share/Temp/station/#{strtime[0,8]}/&quot;</span>

        <span class="ruby-comment"># Read hua bei city, do not read data of these city.</span>
        <span class="ruby-identifier">firstline</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-identifier">hb_city</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>

        <span class="ruby-comment"># puts c.city_name_pinyin</span>
        <span class="ruby-identifier">py</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">city_name_pinyin</span>.<span class="ruby-identifier">strip</span>

        <span class="ruby-identifier">fn</span> = <span class="ruby-node">&quot;XJ_ENVAQFC_#{py}_#{yesterday_str}_00000-07200.TXT&quot;</span>
        <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span><span class="ruby-operator">+</span><span class="ruby-identifier">fn</span>) 
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">f</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> 
                <span class="ruby-identifier">parse_line</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">c</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
        <span class="ruby-comment"># puts fn+&quot; update database successful!&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_bd_month" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_bd_month</span><span
            class="method-args">(time,id)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="set_bd_month-source">
            <pre><span class="ruby-comment"># File vendor/bd_save_month_year.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_bd_month</span>(<span class="ruby-identifier">time</span>,<span class="ruby-identifier">id</span>)
        <span class="ruby-identifier">flag</span>=<span class="ruby-string">&#39;temp_bd_months&#39;</span>
        <span class="ruby-identifier">save_db</span>(<span class="ruby-identifier">time</span>,<span class="ruby-identifier">id</span>,<span class="ruby-identifier">flag</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_bd_year" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_bd_year</span><span
            class="method-args">(time,id)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="set_bd_year-source">
            <pre><span class="ruby-comment"># File vendor/bd_save_month_year.rb, line 28</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_bd_year</span>(<span class="ruby-identifier">time</span>,<span class="ruby-identifier">id</span>)
        <span class="ruby-identifier">flag</span> = <span class="ruby-string">&#39;temp_bd_years&#39;</span>
        <span class="ruby-identifier">save_db</span>(<span class="ruby-identifier">time</span>,<span class="ruby-identifier">id</span>,<span class="ruby-identifier">flag</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_change_rate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_change_rate</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="set_change_rate-source">
            <pre><span class="ruby-comment"># File vendor/bd_save_month_year.rb, line 3</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_change_rate</span>
        <span class="ruby-identifier">flag</span>=<span class="ruby-string">&#39;temp_bd_days&#39;</span>
        <span class="ruby-identifier">t</span>=<span class="ruby-identifier">get_db_data</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-string">&#39;last&#39;</span>,<span class="ruby-string">&#39;&#39;</span>)
        <span class="ruby-identifier">t</span>.<span class="ruby-identifier">zonghezhishu</span>=<span class="ruby-identifier">get_zonghezhishu</span>(<span class="ruby-identifier">flag</span>)
        <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;==&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">flag</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;==&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">data_real_time</span>.<span class="ruby-identifier">to_s</span><span class="ruby-operator">+</span><span class="ruby-string">&#39;=Save OK!==&#39;</span>
        <span class="ruby-identifier">t</span>=<span class="ruby-identifier">get_db_data</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-string">&#39;last&#39;</span>,<span class="ruby-string">&#39;&#39;</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">data_real_time</span>.<span class="ruby-identifier">year</span>.<span class="ruby-identifier">to_i</span><span class="ruby-operator">&gt;</span><span class="ruby-value">2014</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">change_rate</span>=<span class="ruby-identifier">get_change_rate</span>(<span class="ruby-identifier">flag</span>,<span class="ruby-identifier">t</span>.<span class="ruby-identifier">id</span>,<span class="ruby-identifier">t</span>.<span class="ruby-identifier">data_real_time</span>)
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">SO2_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:SO2</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">NO2_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:NO2</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">CO_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:CO</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-constant">O3_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:O3</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">pm10_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:pm10</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">pm25_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:pm25</span>]
                <span class="ruby-identifier">day_city</span>.<span class="ruby-identifier">zongheindex_change_rate</span>=<span class="ruby-identifier">change_rate</span>[<span class="ruby-value">:zhzs</span>]
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">set_bd_month</span>(<span class="ruby-identifier">t</span>.<span class="ruby-identifier">data_real_time</span>,<span class="ruby-identifier">t</span>.<span class="ruby-identifier">city_id</span>)
        <span class="ruby-identifier">set_bd_year</span>(<span class="ruby-identifier">t</span>.<span class="ruby-identifier">data_real_time</span>,<span class="ruby-identifier">t</span>.<span class="ruby-identifier">city_id</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-seven_hours_avg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">seven_hours_avg</span><span
            class="method-args">(time)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="seven_hours_avg-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix_qhd.rb, line 28</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">seven_hours_avg</span>(<span class="ruby-identifier">time</span>)
        <span class="ruby-identifier">temp</span>=<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">data</span>=<span class="ruby-identifier">read_qhd_file</span>()
<span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-operator">&lt;</span> <span class="ruby-constant">HEAD</span>
        (<span class="ruby-value">-3</span><span class="ruby-operator">..</span><span class="ruby-value">3</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">temp</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">data</span>[<span class="ruby-identifier">time</span><span class="ruby-operator">+</span><span class="ruby-identifier">n</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>] <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">data</span>[<span class="ruby-identifier">time</span><span class="ruby-operator">+</span><span class="ruby-identifier">n</span><span class="ruby-operator">*</span><span class="ruby-value">3600</span>].<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>,<span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span><span class="ruby-operator">+=</span><span class="ruby-identifier">x</span>}<span class="ruby-operator">/</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-station_ext" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">station_ext</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>遍历station</p>
          
          

          
          <div class="method-source-code" id="station_ext-source">
            <pre><span class="ruby-comment"># File vendor/fore_fix/fore_fix.rb, line 316</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">station_ext</span>
        <span class="ruby-identifier">firstline</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-identifier">city</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-constant">IO</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-string">&quot;vendor/station.EXT&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">firstline</span>
                        <span class="ruby-identifier">city</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
                        <span class="ruby-keyword">next</span>
                <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">post_number</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">1</span>,<span class="ruby-value">7</span>]
                <span class="ruby-identifier">latitude</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">8</span>,<span class="ruby-value">8</span>]
                <span class="ruby-identifier">longitude</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">16</span>,<span class="ruby-value">8</span>]
                <span class="ruby-identifier">city_name_pinyin</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">25</span>,<span class="ruby-value">18</span>].<span class="ruby-identifier">strip</span>
                <span class="ruby-identifier">city</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">city_name_pinyin</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">city</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-wind_power" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">wind_power</span><span
            class="method-args">(wp)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="wind_power-source">
            <pre><span class="ruby-comment"># File test/test.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">wind_power</span>(<span class="ruby-identifier">wp</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">wp</span>[<span class="ruby-value">0</span>,<span class="ruby-value">2</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">wp</span>[<span class="ruby-value">0</span>,<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;微风&#39;</span>
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">in</span> (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">wp</span>.<span class="ruby-identifier">size</span>)
                <span class="ruby-keyword">return</span> <span class="ruby-identifier">wp</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">e</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">wp</span>[<span class="ruby-identifier">e</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;级&#39;</span>
        <span class="ruby-keyword">end</span>           
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

